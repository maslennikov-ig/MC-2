# –ü–ª–∞–Ω –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è TypeScript –æ—à–∏–±–æ–∫ —Å Supabase

## –ü—Ä–æ–±–ª–µ–º–∞
–£ –Ω–∞—Å –∑–∞–º–∫–Ω—É—Ç—ã–π –∫—Ä—É–≥ —Å TypeScript –∏ Supabase:
1. Supabase –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤—ã–≤–æ–¥–∏—Ç —Ç–∏–ø—ã ‚Üí –ø–æ–ª—É—á–∞–µ–º `never`
2. –î–æ–±–∞–≤–ª—è–µ–º `as any` —á—Ç–æ–±—ã –∏—Å–ø—Ä–∞–≤–∏—Ç—å ‚Üí ESLint –∂–∞–ª—É–µ—Ç—Å—è –Ω–∞ `any`
3. –ü—Ä–∏ —Å–±–æ—Ä–∫–µ `any` –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–∏—Å–≤–æ–µ–Ω `never` ‚Üí —Å–±–æ—Ä–∫–∞ –ø–∞–¥–∞–µ—Ç

## –í–∞—Ä–∏–∞–Ω—Ç—ã —Ä–µ—à–µ–Ω–∏—è (–ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É)

### ü•á –í–∞—Ä–∏–∞–Ω—Ç 1: –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ç–∏–ø—ã Supabase (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –í–´–°–û–ö–ò–ô**
**–°–ª–æ–∂–Ω–æ—Å—Ç—å: –°—Ä–µ–¥–Ω—è—è**
**–í—Ä–µ–º—è: 30-60 –º–∏–Ω—É—Ç**

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Supabase CLI –µ—Å–ª–∏ –Ω–µ—Ç
npm install -g supabase

# –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç–∏–ø—ã –∏–∑ –ë–î
supabase gen types typescript --project-id your-project-id > types/database.types.ts
```

–ó–∞—Ç–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–∏–ø—ã:
```typescript
import { Database } from '@/types/database.types'

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–∏–ø—ã –¥–ª—è update
type CourseUpdate = Database['public']['Tables']['courses']['Update']
await supabase
  .from('courses')
  .update({ is_published: !isPublished } as CourseUpdate)
```

**–ü–ª—é—Å—ã:**
- –ü–æ–ª–Ω–∞—è type safety
- –ê–≤—Ç–æ–∫–æ–º–ø–ª–∏—Ç –≤ IDE
- –ù–µ—Ç `any` –≤ –∫–æ–¥–µ

**–ú–∏–Ω—É—Å—ã:**
- –ù—É–∂–Ω–æ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è—Ç—å —Ç–∏–ø—ã
- –¢—Ä–µ–±—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ CI/CD

---

### ü•à –í–∞—Ä–∏–∞–Ω—Ç 2: –°–æ–∑–¥–∞—Ç—å —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ç–∏–ø—ã –¥–ª—è –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö –º–µ—Å—Ç
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –°–†–ï–î–ù–ò–ô**
**–°–ª–æ–∂–Ω–æ—Å—Ç—å: –ù–∏–∑–∫–∞—è**
**–í—Ä–µ–º—è: 15-30 –º–∏–Ω—É—Ç**

–°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª `types/supabase-overrides.ts`:
```typescript
// –¢–∏–ø—ã –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
export type CourseUpdatePayload = {
  is_published?: boolean
  title?: string
  description?: string
  // ... –¥—Ä—É–≥–∏–µ –ø–æ–ª—è
}

export type SectionFromDB = {
  id: string
  section_number: number
  course_id: string
  // ... –¥—Ä—É–≥–∏–µ –ø–æ–ª—è
}

export type LessonFromDB = {
  id: string
  lesson_number: number
  section_id: string
  // ... –¥—Ä—É–≥–∏–µ –ø–æ–ª—è
}
```

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:
```typescript
import { CourseUpdatePayload } from '@/types/supabase-overrides'

await supabase
  .from('courses')
  .update({ is_published: !isPublished } satisfies CourseUpdatePayload)

// –î–ª—è map –æ–ø–µ—Ä–∞—Ü–∏–π
sections?.map((s: SectionFromDB) => s.id)
```

**–ü–ª—é—Å—ã:**
- –ë—ã—Å—Ç—Ä–æ–µ —Ä–µ—à–µ–Ω–∏–µ
- –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ —Ç–∏–ø–∞–º–∏
- –ù–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

**–ú–∏–Ω—É—Å—ã:**
- –†—É—á–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç–∏–ø–æ–≤
- –ú–æ–≥—É—Ç —Ä–∞—Å—Ö–æ–¥–∏—Ç—å—Å—è —Å –ë–î

---

### ü•â –í–∞—Ä–∏–∞–Ω—Ç 3: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å type assertions —Å Database —Ç–∏–ø–∞–º–∏
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –ù–ò–ó–ö–ò–ô (–≤—Ä–µ–º–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ)**
**–°–ª–æ–∂–Ω–æ—Å—Ç—å: –û—á–µ–Ω—å –Ω–∏–∑–∫–∞—è**
**–í—Ä–µ–º—è: 5-10 –º–∏–Ω—É—Ç**

```typescript
// –í–º–µ—Å—Ç–æ as any –∏—Å–ø–æ–ª—å–∑—É–µ–º –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ç–∏–ø—ã
await supabase
  .from('courses')
  .update({ is_published: !isPublished } as Pick<Course, 'is_published'>)

// –î–ª—è –º–∞—Å—Å–∏–≤–æ–≤
const typedSections = sections as Array<{id: string, section_number: number}>
typedSections?.map(s => s.id)
```

**–ü–ª—é—Å—ã:**
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
- –ë—ã—Å—Ç—Ä–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

**–ú–∏–Ω—É—Å—ã:**
- –ù–µ —Ä–µ—à–∞–µ—Ç –∫–æ—Ä–Ω–µ–≤—É—é –ø—Ä–æ–±–ª–µ–º—É
- Type assertions –Ω–µ–±–µ–∑–æ–ø–∞—Å–Ω—ã

---

### ‚ùå –í–∞—Ä–∏–∞–Ω—Ç 4: –û—Ç–∫–ª—é—á–∏—Ç—å ESLint –ø—Ä–∞–≤–∏–ª–∞ (–ù–ï –†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –û–ß–ï–ù–¨ –ù–ò–ó–ö–ò–ô**
**–°–ª–æ–∂–Ω–æ—Å—Ç—å: –û—á–µ–Ω—å –Ω–∏–∑–∫–∞—è**
**–í—Ä–µ–º—è: 2 –º–∏–Ω—É—Ç—ã**

–í `.eslintrc.js`:
```javascript
rules: {
  '@typescript-eslint/no-explicit-any': 'warn', // –∏–ª–∏ 'off'
}
```

–ò–ª–∏ –ª–æ–∫–∞–ª—å–Ω–æ:
```typescript
// eslint-disable-next-line @typescript-eslint/no-explicit-any
sections?.map((s: any) => s.id)
```

**–ü–ª—é—Å—ã:**
- –°–∞–º–æ–µ –±—ã—Å—Ç—Ä–æ–µ "—Ä–µ—à–µ–Ω–∏–µ"

**–ú–∏–Ω—É—Å—ã:**
- –¢–µ—Ä—è–µ–º type safety
- –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –¥–æ–ª–≥
- –ù–µ —Ä–µ—à–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É —Å `never`

---

## –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –ø–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π

### –®–∞–≥ 1: –ë—ã—Å—Ç—Ä–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–ª—è –¥–µ–ø–ª–æ—è (5 –º–∏–Ω—É—Ç)
```typescript
// app/courses/actions.ts - —É–±—Ä–∞—Ç—å as any, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å @ts-ignore
// @ts-ignore - Supabase type inference issue
await supabase
  .from('courses')
  .update({ is_published: !isPublished })
```

### –®–∞–≥ 2: –°–æ–∑–¥–∞—Ç—å –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–∏–ø—ã (15 –º–∏–Ω—É—Ç)
–°–æ–∑–¥–∞—Ç—å `types/supabase-overrides.ts` —Å —Ç–∏–ø–∞–º–∏ –¥–ª—è –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö –º–µ—Å—Ç

### –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é —Ç–∏–ø–æ–≤ (30 –º–∏–Ω—É—Ç)
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Supabase CLI
2. –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Ç–∏–ø—ã
3. –û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ –∏–º–ø–æ—Ä—Ç—ã
4. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å GitHub Action –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

### –®–∞–≥ 4: –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ (–ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ)
–ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –∑–∞–º–µ–Ω—è—Ç—å –≤—Å–µ `any` –∏ `@ts-ignore` –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–¥

---

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

```bash
# –õ–æ–∫–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
pnpm type-check  # –î–æ–ª–∂–Ω–æ –ø—Ä–æ–π—Ç–∏
pnpm build       # –î–æ–ª–∂–Ω–æ —Å–æ–±—Ä–∞—Ç—å—Å—è
pnpm lint        # –ú–∏–Ω–∏–º—É–º warnings

# Docker build
docker build -t courseai-test .
```

---

## –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏
- [Supabase TypeScript Guide](https://supabase.com/docs/guides/api/rest/generating-types)
- [Next.js TypeScript](https://nextjs.org/docs/app/building-your-application/configuring/typescript)
- [–†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º —Å never type](https://github.com/supabase/supabase-js/issues/756)

---

## –ò—Ç–æ–≥
**–î–ª—è —Å—Ä–æ—á–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è:** –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `@ts-ignore` (–®–∞–≥ 1)
**–î–ª—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è:** –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é —Ç–∏–ø–æ–≤ (–í–∞—Ä–∏–∞–Ω—Ç 1)

---

## TODO: –£–±—Ä–∞—Ç—å –±—ã—Å—Ç—Ä—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### ‚ö†Ô∏è –í–ê–ñ–ù–û: –í—Ä–µ–º–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –¥–ª—è –¥–µ–ø–ª–æ—è (2025-01-14)

–í –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –¥–ª—è —Å—Ä–æ—á–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è –±—ã–ª–∏ —É–¥–∞–ª–µ–Ω—ã –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ `@ts-expect-error` –¥–∏—Ä–µ–∫—Ç–∏–≤—ã –≤ —Å–ª–µ–¥—É—é—â–∏—Ö —Ñ–∞–π–ª–∞—Ö:

1. **app/api/courses/paginated/route.ts**
   - –£–¥–∞–ª–µ–Ω `@ts-expect-error` –Ω–∞ —Å—Ç—Ä–æ–∫–µ ~189 (–ø—Ä–æ–≤–µ—Ä–∫–∞ firstItem)
   - TypeScript –±–æ–ª—å—à–µ –Ω–µ –≤–∏–¥–∏—Ç –æ—à–∏–±–∫–∏ –≤ —ç—Ç–∏—Ö –º–µ—Å—Ç–∞—Ö

2. **app/courses/[slug]/page.tsx**
   - –£–¥–∞–ª–µ–Ω—ã —Ç—Ä–∏ `@ts-expect-error` –¥–∏—Ä–µ–∫—Ç–∏–≤—ã:
     - –°—Ç—Ä–æ–∫–∞ ~46 (–ø–æ–ª—É—á–µ–Ω–∏–µ lessons)
     - –°—Ç—Ä–æ–∫–∞ ~53 (–ø–æ–ª—É—á–µ–Ω–∏–µ assets)
     - –°—Ç—Ä–æ–∫–∏ ~72 –∏ ~84 (—Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö)

3. **app/courses/actions.ts**
   - –£–¥–∞–ª–µ–Ω `@ts-expect-error` –Ω–∞ —Å—Ç—Ä–æ–∫–µ ~362 (update –æ–ø–µ—Ä–∞—Ü–∏—è)

### üìã –ü–ª–∞–Ω –ø–æ —É–¥–∞–ª–µ–Ω–∏—é –±—ã—Å—Ç—Ä—ã—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:

1. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –≥–µ–Ω–µ—Ä–∞—Ü–∏—é —Ç–∏–ø–æ–≤ Supabase (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –í–´–°–û–ö–ò–ô)**
   ```bash
   supabase gen types typescript --project-id your-project-id > types/database.generated.ts
   ```

2. **–û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ –∏–º–ø–æ—Ä—Ç—ã —Ç–∏–ø–æ–≤**
   - –ó–∞–º–µ–Ω–∏—Ç—å `@/types/database` –Ω–∞ `@/types/database.generated`
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–∏–ø—ã –¥–ª—è –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π —Å –ë–î

3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏ —É–¥–∞–ª–∏—Ç—å –æ—Å—Ç–∞–≤—à–∏–µ—Å—è type assertions**
   - –ù–∞–π—Ç–∏ –≤—Å–µ –º–µ—Å—Ç–∞ —Å `as any`
   - –ó–∞–º–µ–Ω–∏—Ç—å –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ç–∏–ø—ã –∏–∑ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞

4. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –≥–µ–Ω–µ—Ä–∞—Ü–∏—é —Ç–∏–ø–æ–≤ –≤ CI/CD**
   - –î–æ–±–∞–≤–∏—Ç—å –≤ GitHub Actions —à–∞–≥ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ç–∏–ø–æ–≤
   - –ü—Ä–æ–≤–µ—Ä—è—Ç—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ç–∏–ø–æ–≤ –ø—Ä–∏ –∫–∞–∂–¥–æ–º PR

### üîç –ü–æ–∏—Å–∫ –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è –±—ã—Å—Ç—Ä—ã—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
```bash
# –ù–∞–π—Ç–∏ –≤—Å–µ @ts-ignore –∏ @ts-expect-error
grep -r "@ts-ignore\|@ts-expect-error" app/ components/ lib/

# –ù–∞–π—Ç–∏ –≤—Å–µ as any
grep -r "as any" app/ components/ lib/
```

### ‚úÖ –ö—Ä–∏—Ç–µ—Ä–∏–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:
- [ ] –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ —Ç–∏–ø—ã –∏–∑ –ë–î
- [ ] –£–¥–∞–ª–µ–Ω—ã –≤—Å–µ `@ts-ignore` –∏ `@ts-expect-error`
- [ ] –£–¥–∞–ª–µ–Ω—ã –≤—Å–µ `as any` —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å Supabase
- [ ] –°–±–æ—Ä–∫–∞ –ø—Ä–æ—Ö–æ–¥–∏—Ç –±–µ–∑ warnings –æ —Ç–∏–ø–∞—Ö
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–∏–ø–æ–≤