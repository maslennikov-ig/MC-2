# Финальное сравнение качества генерации уроков

**Дата тестирования:** 16 декабря 2025
**Всего моделей:** 8
**Тестов на модель:** 4 (2 RU + 2 EN)

---

## Сводная таблица результатов

| # | Модель | API Name | RU | EN | JSON | Score | Скорость | Рейтинг |
|---|--------|----------|----|----|------|-------|----------|---------|
| 1 | **Qwen3 235B Instruct** | `qwen/qwen3-235b-a22b-2507` | 2/2 | 2/2 | 100% | **100** | 74s | **A+** |
| 2 | **Qwen3 235B Thinking** | `qwen/qwen3-235b-a22b-thinking-2507` | 2/2 | 2/2 | 100% | **100** | 175s | A+ |
| 3 | **Nemotron Nano 9B V2** | `nvidia/nemotron-nano-9b-v2` | 2/2 | 2/2 | 100% | **100** | 83s | **A** |
| 4 | **GPT-OSS-120B** | `openai/gpt-oss-120b` | 2/2 | 2/2 | 100% | **95** | ~90s | A |
| 5 | DeepSeek V3.2 | `deepseek/deepseek-v3.2` | 1/2 | 2/2 | 75% | 100* | 880s | B |
| 6 | Devstral 2512 | `mistralai/devstral-2512:free` | 1/2 | 2/2 | 75% | 100* | 186s | B |
| 7 | GPT-OSS-20B | `openai/gpt-oss-20b` | 2/2 | 2/2 | 100% | 85 | ~100s | B- |
| 8 | Nemotron Nano 30B (free) | `nvidia/nemotron-3-nano-30b-a3b:free` | 0/2 | 0/2 | 0% | 0 | N/A | F |

*\* Score только для успешных тестов*

---

## Ключевые открытия

### 1. Nemotron Nano 9B V2 — новый сильный кандидат

**Результат:** 4/4 тестов, 100/100, 83 секунды

Модель показала отличные результаты:
- Стабильный JSON output
- Хорошее качество контента
- Быстрая генерация (83s на 4 теста)
- **Меньше параметров (9B vs 235B)**, но сопоставимое качество

**Небольшой минус:** В русском контенте иногда проскакивают английские термины (`intangible товар`).

### 2. DeepSeek V3.2 — проблемы с русским

При последовательном запуске улучшился до 3/4, но **урок 1.1 на русском генерирует галлюцинации**:

```
"intro": "Добробуте! Если вы работаете в Менеджер и управете билетов...
он is право на участие в мероприя، на ведж вкал..."
```

Это смесь русского, английского, вьетнамского и китайского. **Не рекомендуется для русского контента.**

### 3. Devstral 2512 — стабильная проблема с кавычками

Независимо от параллельного/последовательного запуска, урок 1.1 на русском fail из-за смешения:
- `\"` (правильные escaped quotes)
- `"` (fancy Unicode quotes)

**Решение:** Post-processing нормализации кавычек.

---

## Сравнение: Qwen3 Instruct vs Thinking

| Параметр | Instruct | Thinking | Победитель |
|----------|----------|----------|------------|
| Качество | 100/100 | 100/100 | Ничья |
| **Скорость** | **74s** | 175s | **Instruct** |
| Стиль RU | Практичный | Нарративный | По вкусу |
| Стиль EN | Чёткий | Концептуальный | По вкусу |
| JSON | 100% | 100% | Ничья |
| Стоимость | Ниже | Выше (reasoning) | Instruct |

**Вывод:** Qwen3 Instruct в **2.4x быстрее** при том же качестве.

---

## Детальный анализ по категориям

### Tier 1: Лидеры (Рекомендуются для production)

#### 1. Qwen3 235B Instruct — ЛУЧШИЙ ВЫБОР

| Метрика | Значение |
|---------|----------|
| JSON Success | 100% (4/4) |
| Quality Score | 100/100 |
| Скорость | 74s (4 теста) |
| RU качество | Отличное |
| EN качество | Отличное |

**Пример контента (RU):**
> «CRM — это его навигатор. Он подсказывает: "Через 500 метров купите билет", "Не забудьте о начале мероприятия", "Вот правила входа".»

**Рекомендация:** Основная модель для Stage 6.

---

#### 2. Nemotron Nano 9B V2 — ЛУЧШЕЕ СООТНОШЕНИЕ ЦЕНА/КАЧЕСТВО

| Метрика | Значение |
|---------|----------|
| JSON Success | 100% (4/4) |
| Quality Score | 100/100 |
| Скорость | 83s (4 теста) |
| Параметры | 9B (vs 235B у Qwen) |

**Пример контента (EN):**
> «CRM systems act as 'navigators' in ticket sales by guiding customers through the purchasing process. Just as a navigator helps travelers find their way, CRM tools track customer interactions, preferences, and behaviors.»

**Особенности:**
- В 26x меньше параметров чем Qwen 235B
- Сопоставимое качество
- Иногда примесь английского в русском

**Рекомендация:** Отличная альтернатива для экономии бюджета.

---

#### 3. GPT-OSS-120B — Надёжная альтернатива

| Метрика | Значение |
|---------|----------|
| JSON Success | 100% (4/4) |
| Quality Score | 95/100 |
| Стиль | Академический |

**Рекомендация:** Fallback модель.

---

### Tier 2: Условно пригодные

#### DeepSeek V3.2 — Только для английского

| Тест | Результат |
|------|-----------|
| 1.1 RU | ❌ Галлюцинации (mixed languages) |
| 1.2 RU | ✅ 100/100 |
| 1.1 EN | ✅ 100/100 |
| 1.2 EN | ✅ 100/100 |

**Вердикт:** Можно использовать **только для EN контента**.

---

#### Devstral 2512 — Требует post-processing

| Тест | Результат |
|------|-----------|
| 1.1 RU | ❌ Parse error (fancy quotes) |
| 1.2 RU | ✅ 100/100 |
| 1.1 EN | ✅ 100/100 |
| 1.2 EN | ✅ 100/100 |

**Решение:** Добавить нормализацию кавычек:
```javascript
cleaned = cleaned.replace(/[""]/g, '"');
```

---

### Tier 3: Не рекомендуются

| Модель | Причина |
|--------|---------|
| **Nemotron Nano 30B (free)** | 0% success, невалидный JSON |
| **GPT-OSS-20B** | Упражнения с готовыми ответами |
| **Qwen3 235B Thinking** | Медленнее без преимуществ |

---

## Итоговые рейтинги

### Рейтинг для русского контента

| # | Модель | Score | Особенности |
|---|--------|-------|-------------|
| 1 | **Qwen3 235B Instruct** | 100 | Лучший русский |
| 2 | Nemotron Nano 9B V2 | 100 | Иногда EN-примеси |
| 3 | GPT-OSS-120B | 95 | Академичный |
| 4 | GPT-OSS-20B | 85 | Ошибки в exercises |
| 5 | DeepSeek V3.2 | 50%* | Галлюцинации |
| 6 | Devstral 2512 | 50%* | Parse errors |
| 7 | Nemotron 30B (free) | 0 | Не работает |

### Рейтинг для английского контента

| # | Модель | Score | Особенности |
|---|--------|-------|-------------|
| 1 | **Qwen3 235B Instruct** | 100 | Лучший |
| 2 | Nemotron Nano 9B V2 | 100 | Отличный |
| 3 | DeepSeek V3.2 | 100 | Стабильный |
| 4 | Devstral 2512 | 100 | Стабильный |
| 5 | GPT-OSS-120B | 95 | Академичный |
| 6 | GPT-OSS-20B | 85 | Приемлемый |
| 7 | Nemotron 30B (free) | 0 | Не работает |

---

## Рекомендации для Stage 6 Pipeline

### Основная модель: `qwen/qwen3-235b-a22b-2507`

**Причины:**
1. 100% стабильность JSON
2. Лучшее качество на обоих языках
3. Быстрая генерация
4. Практичный стиль для корпоративного обучения

### Альтернатива (бюджетная): `nvidia/nemotron-nano-9b-v2`

**Когда использовать:**
- Ограниченный бюджет
- Большой объём генерации
- Преимущественно EN контент

### Fallback: `openai/gpt-oss-120b`

**Когда использовать:**
- Если основные модели недоступны
- Для академического стиля

### НЕ использовать:

| Модель | Причина |
|--------|---------|
| `deepseek/deepseek-v3.2` | Галлюцинации на RU |
| `nvidia/nemotron-3-nano-30b-a3b:free` | 0% success |
| `qwen/qwen3-235b-a22b-thinking-2507` | Медленнее без преимуществ |

---

## Технические рекомендации

### 1. Post-processing для JSON

```javascript
function cleanJsonResponse(text) {
  let cleaned = text
    .replace(/```json\s*/g, '')
    .replace(/```\s*/g, '')
    .replace(/[""]/g, '"')  // Normalize fancy quotes
    .replace(/['']/g, "'")
    .trim();

  const firstBrace = cleaned.indexOf('{');
  const lastBrace = cleaned.lastIndexOf('}');
  if (firstBrace !== -1 && lastBrace !== -1) {
    cleaned = cleaned.substring(firstBrace, lastBrace + 1);
  }
  return cleaned;
}
```

### 2. Параллельность запросов

| Модель | Рекомендация |
|--------|--------------|
| Qwen3 235B | ✅ Параллельно (4+) |
| GPT-OSS-120B | ✅ Параллельно (4+) |
| Nemotron 9B V2 | ✅ Параллельно (4+) |
| DeepSeek V3.2 | ⚠️ Последовательно или по 2 |
| Devstral 2512 | ⚠️ Последовательно |

### 3. Промпт для стабильного JSON

```
CRITICAL: Return ONLY valid JSON.
No markdown code blocks around the JSON.
Use only standard ASCII quotes (\") in JSON strings.
Write ALL content in [Russian/English].
```

---

## Заключение

**Топ-3 модели для генерации уроков:**

| # | Модель | Использование |
|---|--------|---------------|
| 1 | **Qwen3 235B Instruct** | Production (основная) |
| 2 | **Nemotron Nano 9B V2** | Production (бюджетная) |
| 3 | **GPT-OSS-120B** | Fallback |

**Главные выводы:**
- Qwen3 Instruct = Thinking по качеству, но в 2.4x быстрее
- Nemotron 9B V2 — отличное соотношение цена/качество (9B params!)
- DeepSeek не подходит для русского контента
- Старая версия Nemotron 30B (free) полностью непригодна

Sources:
- [Nemotron Nano 9B V2 - OpenRouter](https://openrouter.ai/nvidia/nemotron-nano-9b-v2)
- [Qwen3 235B Instruct - OpenRouter](https://openrouter.ai/qwen/qwen3-235b-a22b-2507)
