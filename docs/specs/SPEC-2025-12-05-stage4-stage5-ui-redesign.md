# –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ: –†–µ–¥–∏–∑–∞–π–Ω UI Stage 4-5 –¥–ª—è —Å–æ–∑–¥–∞—Ç–µ–ª–µ–π –∫—É—Ä—Å–æ–≤

**–í–µ—Ä—Å–∏—è:** 1.2.0
**–î–∞—Ç–∞:** 2025-12-05
**–°—Ç–∞—Ç—É—Å:** Ready for Implementation
**–ê–≤—Ç–æ—Ä:** Claude + Igor

---

## –û—Å–Ω–æ–≤–∞–Ω–æ –Ω–∞ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è—Ö

–î–∞–Ω–Ω–æ–µ –¢–ó —É—á–∏—Ç—ã–≤–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã Deep Research:
- [AI Course Builder Regeneration Best Practices](../research/AI%20Course%20Builder%20Regeneration%20Best%20Practices.md)
- [Partial content regeneration in AI course builders](../research/Partial%20content%20regeneration%20in%20AI%20course%20builders%20A%20technical%20guide.md)

–ö–ª—é—á–µ–≤—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ –∏–∑ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π:
- **Constructive Alignment** ‚Äî LO ‚Üí Content ‚Üí Assessment –∫–∞–∫ –≥—Ä–∞—Ñ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- **Tiered Context Strategy** ‚Äî 4 —É—Ä–æ–≤–Ω—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Ç–æ–∫–µ–Ω–æ–≤
- **Lost in the Middle** ‚Äî –∫—Ä–∏—Ç–∏—á–µ—Å–∫—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –≤ –Ω–∞—á–∞–ª–æ/–∫–æ–Ω–µ—Ü –ø—Ä–æ–º–ø—Ç–∞
- **Stale Data Indicators** ‚Äî –≤–∏–∑—É–∞–ª—å–Ω–∞—è –∏–Ω–¥–∏–∫–∞—Ü–∏—è —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- **Impact Analysis Modal** ‚Äî –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ –∫–∞—Å–∫–∞–¥–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö

---

## 1. –í–≤–µ–¥–µ–Ω–∏–µ

### 1.1 –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ

–†–µ–¥–∏–∑–∞–π–Ω –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ Stage 4 (–ê–Ω–∞–ª–∏–∑) –∏ Stage 5 (–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã) –≤ —Ä–∞—Å–∫—Ä—ã–≤–∞–µ–º–æ–π –ø–∞–Ω–µ–ª–∏ –Ω–æ–¥—ã –≥—Ä–∞—Ñ–∞. –¶–µ–ª—å ‚Äî —Å–¥–µ–ª–∞—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø–æ–Ω—è—Ç–Ω—ã–º –¥–ª—è –º–µ—Ç–æ–¥–æ–ª–æ–≥–æ–≤, –∏–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–æ–≤ –∏ —Å–æ–∑–¥–∞—Ç–µ–ª–µ–π –∫—É—Ä—Å–æ–≤, –∞ –Ω–µ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤.

### 1.2 –¶–µ–ª–µ–≤–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è

- **–ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏** ‚Äî —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç—ã –ø–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º
- **–ò–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä—ã** ‚Äî –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–∏, —Å–æ–∑–¥–∞—é—â–∏–µ –∫—É—Ä—Å—ã
- **–°–æ–∑–¥–∞—Ç–µ–ª–∏ –∫—É—Ä—Å–æ–≤** ‚Äî —ç–∫—Å–ø–µ—Ä—Ç—ã –ø—Ä–µ–¥–º–µ—Ç–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏ –±–µ–∑ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ –±—ç–∫–≥—Ä–∞—É–Ω–¥–∞

### 1.3 –ü—Ä–æ–±–ª–µ–º—ã —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

| –ü—Ä–æ–±–ª–µ–º–∞ | –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ | –í–ª–∏—è–Ω–∏–µ –Ω–∞ UX |
|----------|-------------------|---------------|
| –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è | "Attempt 1, 2, 3..." –≤–º–µ—Å—Ç–æ —Ñ–∞–∑ | –ù–µ–ø–æ–Ω—è—Ç–Ω–æ —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç |
| JSON-–≤—ã–≤–æ–¥ | `JsonViewer` –¥–ª—è output | –ù–µ—á–∏—Ç–∞–µ–º–æ –¥–ª—è –Ω–µ—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π |
| –ù–µ—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è | Output —Ç–æ–ª—å–∫–æ –¥–ª—è —á—Ç–µ–Ω–∏—è | –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –æ—à–∏–±–∫–∏ AI |
| –°–∫—Ä—ã—Ç—ã–π —á–∞—Ç | `RefinementChat` —Å–≤—ë—Ä–Ω—É—Ç | –ù–µ–æ—á–µ–≤–∏–¥–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø–µ—Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ |
| –ù–µ—Ç –∞–≤—Ç–æ-—Ä–∞—Å–∫—Ä—ã—Ç–∏—è | –¢–æ–ª—å–∫–æ Stage 3 –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è | Stage 4/5 —Ç—Ä–µ–±—É—é—Ç —Ä—É—á–Ω–æ–≥–æ –æ—Ç–∫—Ä—ã—Ç–∏—è |

---

## 2. –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### 2.1 FR-001: –ß–µ–ª–æ–≤–µ–∫–æ-–ø–æ–Ω—è—Ç–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è —Ñ–∞–∑

**–ë—ã–ª–æ:** `Attempt 1 - 12:34:56 (success)`
**–°—Ç–∞–ª–æ:** –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º

#### Stage 4 ‚Äî –§–∞–∑—ã –∞–Ω–∞–ª–∏–∑–∞

| –í–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ –∏–º—è | –û—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ (RU) | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------------|---------------------------|----------|
| phase_0 | –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ | –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ |
| phase_1 | –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è | –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ —Ç–µ–º—ã –∫—É—Ä—Å–∞ |
| phase_2 | –ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—ä—ë–º–∞ | –†–∞—Å—á—ë—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —É—Ä–æ–∫–æ–≤ –∏ —Å–µ–∫—Ü–∏–π |
| phase_3 | –≠–∫—Å–ø–µ—Ä—Ç–Ω—ã–π –∞–Ω–∞–ª–∏–∑ | –í—ã–±–æ—Ä –ø–µ–¥–∞–≥–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ |
| phase_4 | –°–∏–Ω—Ç–µ–∑ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ | –ê–Ω–∞–ª–∏–∑ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ |
| phase_6 | RAG-–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ | –°–≤—è–∑—å –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ —Å —Ä–∞–∑–¥–µ–ª–∞–º–∏ –∫—É—Ä—Å–∞ |
| phase_5 | –§–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è | –°–±–æ—Ä–∫–∞ –∏—Ç–æ–≥–æ–≤–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ |

#### Stage 5 ‚Äî –§–∞–∑—ã –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

| –í–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ –∏–º—è | –û—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ (RU) | –û–ø–∏—Å–∞–Ω–∏–µ |
|----------------|---------------------------|----------|
| validate_input | –í–∞–ª–∏–¥–∞—Ü–∏—è | –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö |
| generate_metadata | –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ | –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ–ø–∏—Å–∞–Ω–∏—è –∫—É—Ä—Å–∞ |
| generate_sections | –°—Ç—Ä—É–∫—Ç—É—Ä–∞ | –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ–∫—Ü–∏–π –∏ —É—Ä–æ–∫–æ–≤ |
| validate_quality | –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ | –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º |
| validate_lessons | –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Ä–æ–∫–æ–≤ | –ú–∏–Ω–∏–º—É–º 10 —É—Ä–æ–∫–æ–≤ |

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
- `AttemptSelector.tsx` ‚Üí `PhaseSelector.tsx`
- –ù–æ–≤—ã–π —Ñ–∞–π–ª: `phase-names.ts` —Å –ø–µ—Ä–µ–≤–æ–¥–∞–º–∏

---

### 2.2 FR-002: –ß–µ–ª–æ–≤–µ–∫–æ-–ø–æ–Ω—è—Ç–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ Output

#### Stage 4 (AnalysisResult) ‚Äî –†–∞–∑–¥–µ–ª—ã

–ö–∞–∂–¥–∞—è —Ñ–∞–∑–∞ = –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ä–∞–∑–¥–µ–ª —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

**1. –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –∫—É—Ä—Å–∞** (`course_category`, `contextual_language`)
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ üìö –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –∫—É—Ä—Å–∞                            [‚úèÔ∏è] ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ –ö–∞—Ç–µ–≥–æ—Ä–∏—è: –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π                             ‚îÇ
‚îÇ –£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å: 92%                                        ‚îÇ
‚îÇ                                                         ‚îÇ
‚îÇ –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è:                                  ‚îÇ
‚îÇ ‚Ä¢ –ü–æ—á–µ–º—É —ç—Ç–æ –≤–∞–∂–Ω–æ: [—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º–æ–µ –ø–æ–ª–µ]               ‚îÇ
‚îÇ ‚Ä¢ –ú–æ—Ç–∏–≤–∞—Ç–æ—Ä—ã: [—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º–æ–µ –ø–æ–ª–µ]                     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**2. –ê–Ω–∞–ª–∏–∑ —Ç–µ–º—ã** (`topic_analysis`)
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ üéØ –ê–Ω–∞–ª–∏–∑ —Ç–µ–º—ã                                    [‚úèÔ∏è] ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ –¢–µ–º–∞: [—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫]                        ‚îÇ
‚îÇ –°–ª–æ–∂–Ω–æ—Å—Ç—å: –°—Ä–µ–¥–Ω—è—è                                      ‚îÇ
‚îÇ –ê—É–¥–∏—Ç–æ—Ä–∏—è: –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ                                  ‚îÇ
‚îÇ                                                         ‚îÇ
‚îÇ –ö–ª—é—á–µ–≤—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏:                                     ‚îÇ
‚îÇ [chips: –º–æ–∂–Ω–æ —É–¥–∞–ª—è—Ç—å/–¥–æ–±–∞–≤–ª—è—Ç—å]                       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**3. –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞** (`recommended_structure`)
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ üìä –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞                        [‚úèÔ∏è] ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ –í—Å–µ–≥–æ —É—Ä–æ–∫–æ–≤: 15 (–º–∏–Ω. 10)                             ‚îÇ
‚îÇ –°–µ–∫—Ü–∏–π: 5                                               ‚îÇ
‚îÇ –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —É—Ä–æ–∫–∞: 15 –º–∏–Ω                              ‚îÇ
‚îÇ –û–±—â–µ–µ –≤—Ä–µ–º—è: 3.75 —á                                     ‚îÇ
‚îÇ                                                         ‚îÇ
‚îÇ –†–∞–∑–±–∏–≤–∫–∞ –ø–æ —Å–µ–∫—Ü–∏—è–º:                     [–ü–µ—Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å]‚îÇ
‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê               ‚îÇ
‚îÇ ‚îÇ 1. –í–≤–µ–¥–µ–Ω–∏–µ (3 —É—Ä–æ–∫–∞)            [‚úèÔ∏è] ‚îÇ               ‚îÇ
‚îÇ ‚îÇ    ‚Ä¢ –í–∞–∂–Ω–æ—Å—Ç—å: ‚≠ê –ö–ª—é—á–µ–≤–∞—è             ‚îÇ               ‚îÇ
‚îÇ ‚îÇ    ‚Ä¢ –¶–µ–ª–∏ –æ–±—É—á–µ–Ω–∏—è:                    ‚îÇ               ‚îÇ
‚îÇ ‚îÇ      - [—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º–æ–µ]                 ‚îÇ               ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**4. –ü–µ–¥–∞–≥–æ–≥–∏—á–µ—Å–∫–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è** (`pedagogical_strategy`, `pedagogical_patterns`)
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ üéì –ü–µ–¥–∞–≥–æ–≥–∏—á–µ—Å–∫–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è                       [‚úèÔ∏è] ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ –°—Ç–∏–ª—å –æ–±—É—á–µ–Ω–∏—è: –ü—Ä–∞–∫—Ç–∏–∫–æ-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π               ‚îÇ
‚îÇ –°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Ç–µ–æ—Ä–∏—è/–ø—Ä–∞–∫—Ç–∏–∫–∞: 30:70                      ‚îÇ
‚îÇ –£—Ä–æ–≤–µ–Ω—å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏: –í—ã—Å–æ–∫–∏–π                        ‚îÇ
‚îÇ                                                         ‚îÇ
‚îÇ –¢–∏–ø—ã –∑–∞–¥–∞–Ω–∏–π: [chips]                                   ‚îÇ
‚îÇ –ü–∞—Ç—Ç–µ—Ä–Ω—ã: [chips]                                       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**5. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏** (`generation_guidance`)
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ ‚ú® –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏                      [‚úèÔ∏è] ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ –¢–æ–Ω: –î—Ä—É–∂–µ–ª—é–±–Ω—ã–π, –Ω–æ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–π                   ‚îÇ
‚îÇ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–Ω–∞–ª–æ–≥–∏–∏: –î–∞                               ‚îÇ
‚îÇ                                                         ‚îÇ
‚îÇ –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –∞–Ω–∞–ª–æ–≥–∏–∏: [—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º—ã–π —Å–ø–∏—Å–æ–∫]           ‚îÇ
‚îÇ –í–∏–∑—É–∞–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã: [chips]                            ‚îÇ
‚îÇ –¢–∏–ø—ã —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π: [chips]                                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**6. –°–≤—è–∑—å –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤** (`document_relevance_mapping`)
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ üìé –°–≤—è–∑—å –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ —Å —Ä–∞–∑–¥–µ–ª–∞–º–∏                   [‚úèÔ∏è] ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ –°–µ–∫—Ü–∏—è 1: –í–≤–µ–¥–µ–Ω–∏–µ                                      ‚îÇ
‚îÇ   ‚Ä¢ –î–æ–∫—É–º–µ–Ω—Ç—ã: [file1.pdf, file2.docx]                 ‚îÇ
‚îÇ   ‚Ä¢ –ü–æ–∏—Å–∫–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã: [—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º—ã–µ]                 ‚îÇ
‚îÇ   ‚Ä¢ –£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å: –í—ã—Å–æ–∫–∞—è                                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

#### Stage 5 (CourseStructure) ‚Äî –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ üìñ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫—É—Ä—Å–∞                                      ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ –ù–∞–∑–≤–∞–Ω–∏–µ: [—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º–æ–µ]                               ‚îÇ
‚îÇ –û–ø–∏—Å–∞–Ω–∏–µ: [—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º—ã–π rich-text]                    ‚îÇ
‚îÇ –¶–µ–ª–µ–≤–∞—è –∞—É–¥–∏—Ç–æ—Ä–∏—è: [—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º–æ–µ]                     ‚îÇ
‚îÇ                                                         ‚îÇ
‚îÇ ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê ‚îÇ
‚îÇ                                                         ‚îÇ
‚îÇ –°–µ–∫—Ü–∏—è 1: –û—Å–Ω–æ–≤—ã                            [‚öôÔ∏è] [üîÑ]  ‚îÇ
‚îÇ ‚îú‚îÄ‚îÄ –£—Ä–æ–∫ 1.1: –í–≤–µ–¥–µ–Ω–∏–µ              15 –º–∏–Ω  [‚úèÔ∏è] [üîÑ]  ‚îÇ
‚îÇ ‚îÇ   ‚îî‚îÄ‚îÄ –¶–µ–ª–∏: [—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º—ã–µ]                          ‚îÇ
‚îÇ ‚îÇ   ‚îî‚îÄ‚îÄ –ö–ª—é—á–µ–≤—ã–µ —Ç–µ–º—ã: [chips]                         ‚îÇ
‚îÇ ‚îÇ   ‚îî‚îÄ‚îÄ –£–ø—Ä–∞–∂–Ω–µ–Ω–∏—è: [3 —à—Ç]                             ‚îÇ
‚îÇ ‚îú‚îÄ‚îÄ –£—Ä–æ–∫ 1.2: –ü–µ—Ä–≤—ã–µ —à–∞–≥–∏           15 –º–∏–Ω  [‚úèÔ∏è] [üîÑ]  ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ ...                                                 ‚îÇ
‚îÇ                                                         ‚îÇ
‚îÇ –°–µ–∫—Ü–∏—è 2: –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏             [‚öôÔ∏è] [üîÑ]  ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ ...                                                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

[‚öôÔ∏è] = —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–µ–∫—Ü–∏—é
[üîÑ] = –ø–µ—Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å AI
[‚úèÔ∏è] = —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —É—Ä–æ–∫
```

---

### 2.3 FR-003: Inline-—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –∞–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º

#### –†–µ–∂–∏–º—ã —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

1. **–ü—Ä–æ—Å–º–æ—Ç—Ä** (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é) ‚Äî —Ç–µ–∫—Å—Ç –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–∞–∫ –æ–±—ã—á–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç
2. **–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** ‚Äî –∫–ª–∏–∫ –ø–æ [‚úèÔ∏è] –∏–ª–∏ –ø–æ –ø–æ–ª—é –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç —Ä–µ–¥–∞–∫—Ç–æ—Ä

#### –¢–∏–ø—ã —Ä–µ–¥–∞–∫—Ç–æ—Ä–æ–≤

| –¢–∏–ø –¥–∞–Ω–Ω—ã—Ö | –†–µ–¥–∞–∫—Ç–æ—Ä |
|------------|----------|
| –ö–æ—Ä–æ—Ç–∫–∏–π —Ç–µ–∫—Å—Ç | Inline input |
| –î–ª–∏–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç | Textarea —Å –∞–≤—Ç–æ-–≤—ã—Å–æ—Ç–æ–π |
| –°–ø–∏—Å–æ–∫ —Å—Ç—Ä–æ–∫ | Chips —Å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º/—É–¥–∞–ª–µ–Ω–∏–µ–º |
| Enum | Select dropdown |
| –ß–∏—Å–ª–æ | Number input —Å ¬±–∫–Ω–æ–ø–∫–∞–º–∏ |
| –î–∞/–ù–µ—Ç | Toggle switch |

#### –õ–æ–≥–∏–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è

```typescript
// Debounced –∞–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
const debouncedSave = useDebouncedCallback(
  async (field: string, value: unknown) => {
    setSaveStatus('saving');
    await saveFieldToDatabase(stageId, field, value);
    setSaveStatus('saved');

    // –ü–æ–∫–∞–∑–∞—Ç—å "–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ" –Ω–∞ 2 —Å–µ–∫
    setTimeout(() => setSaveStatus('idle'), 2000);
  },
  1000 // 1 —Å–µ–∫—É–Ω–¥–∞ debounce
);

// –ü—Ä–∏ –ø–æ—Ç–µ—Ä–µ —Ñ–æ–∫—É—Å–∞ ‚Äî –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
const handleBlur = () => {
  debouncedSave.flush();
};
```

#### –ò–Ω–¥–∏–∫–∞—Ü–∏—è —Å—Ç–∞—Ç—É—Å–∞

```
[–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ...] ‚Üí [–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ...] ‚Üí [‚úì –°–æ—Ö—Ä–∞–Ω–µ–Ω–æ] ‚Üí (—Å–∫—Ä—ã—Ç–æ)
```

---

### 2.4 FR-004: Inline-–ø–µ—Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ —á–∞—Ç

#### UI-–ø–∞—Ç—Ç–µ—Ä–Ω

–ö–∞–∂–¥—ã–π —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º—ã–π –±–ª–æ–∫ –∏–º–µ–µ—Ç –∫–Ω–æ–ø–∫—É [üîÑ]:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –ö–ª—é—á–µ–≤—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏:                               [üîÑ] ‚îÇ
‚îÇ [chip1] [chip2] [chip3]                                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                        ‚Üì (–∫–ª–∏–∫ –Ω–∞ üîÑ)
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –ö–ª—é—á–µ–≤—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏:                          [–ó–∞–∫—Ä—ã—Ç—å] ‚îÇ
‚îÇ [chip1] [chip2] [chip3]                                ‚îÇ
‚îÇ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ‚îÇ
‚îÇ üí¨ –ß—Ç–æ –∏–∑–º–µ–Ω–∏—Ç—å?                                       ‚îÇ
‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ
‚îÇ ‚îÇ –î–æ–±–∞–≤—å –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ –ø—Ä–æ GDPR –∏ –∑–∞—â–∏—Ç—É –¥–∞–Ω–Ω—ã—Ö         ‚îÇ ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ
‚îÇ [–ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è: –£–ø—Ä–æ—Å—Ç–∏—Ç—å | –î–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ | ...]  ‚îÇ
‚îÇ                                          [–û—Ç–ø—Ä–∞–≤–∏—Ç—å ‚Üí] ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

#### –ü—Ä–æ—Ü–µ—Å—Å –ø–µ—Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

1. –ö–ª–∏–∫ [üîÑ] ‚Üí —Ä–∞—Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è mini-chat –ø–æ–¥ –±–ª–æ–∫–æ–º
2. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –ò–õ–ò –≤—ã–±–∏—Ä–∞–µ—Ç Quick Action
3. –ö–ª–∏–∫ [–û—Ç–ø—Ä–∞–≤–∏—Ç—å] ‚Üí –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è spinner
4. AI –ø–µ—Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –¢–û–õ–¨–ö–û —ç—Ç–æ—Ç –±–ª–æ–∫
5. –ù–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ—è–≤–ª—è–µ—Ç—Å—è, –º–æ–∂–Ω–æ –ø—Ä–∏–Ω—è—Ç—å –∏–ª–∏ –æ—Ç–º–µ–Ω–∏—Ç—å

#### Quick Actions (–ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ)

| –î–µ–π—Å—Ç–≤–∏–µ | –ü—Ä–æ–º–ø—Ç –¥–ª—è AI |
|----------|---------------|
| –£–ø—Ä–æ—Å—Ç–∏—Ç—å | "–°–¥–µ–ª–∞–π –ø—Ä–æ—â–µ –∏ –ø–æ–Ω—è—Ç–Ω–µ–µ" |
| –†–∞—Å—à–∏—Ä–∏—Ç—å | "–î–æ–±–∞–≤—å –±–æ–ª—å—à–µ –¥–µ—Ç–∞–ª–µ–π" |
| –°–æ–∫—Ä–∞—Ç–∏—Ç—å | "–°–¥–µ–ª–∞–π –±–æ–ª–µ–µ –ª–∞–∫–æ–Ω–∏—á–Ω—ã–º" |
| –ü—Ä–∏–º–µ—Ä—ã | "–î–æ–±–∞–≤—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø—Ä–∏–º–µ—Ä—ã" |
| –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª–∏–∑–º | "–°–¥–µ–ª–∞–π –±–æ–ª–µ–µ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–º" |

#### XML-Structured Prompt Pattern

> **–ò—Å—Ç–æ—á–Ω–∏–∫:** Research ‚Äî Context-Aware Regeneration Pattern, CARE framework

```xml
<system>
You are regenerating a specific block within an educational course about {topic}.
Match the established tone: {tone_description}
Target audience: {audience_level}
Bloom's Taxonomy level required: {bloom_level}
Length constraint: {word_count} ¬± 10%
</system>

<surrounding_context>
<previous_section>{content_before}</previous_section>
<section_to_regenerate>{current_content}</section_to_regenerate>
<following_section>{content_after}</following_section>
</surrounding_context>

<learning_objective>
{aligned_learning_objective}
</learning_objective>

<style_examples>
Example 1: "{style_example_1}"
Example 2: "{style_example_2}"
</style_examples>

<constraints>
- Maintain consistency with the learning objective above
- Preserve logical flow from previous section
- Create natural transition to following section
- Use terminology already established: {key_terms}
- Match the style demonstrated in examples
</constraints>

<output_format>
Return JSON with structure:
{
  "regenerated_content": "...",
  "pedagogical_change_log": "...",
  "alignment_score": 1-5,
  "bloom_level_preserved": true/false,
  "concepts_added": [...],
  "concepts_removed": [...]
}
</output_format>

Regenerate only the content in <section_to_regenerate>.
```

**–ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã:**
- –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (constraints, LO) –≤ **–Ω–∞—á–∞–ª–µ –∏ –∫–æ–Ω—Ü–µ** –ø—Ä–æ–º–ø—Ç–∞
- **2-3 few-shot –ø—Ä–∏–º–µ—Ä–∞** —Å—Ç–∏–ª—è –∏–∑ –¥—Ä—É–≥–∏—Ö —á–∞—Å—Ç–µ–π –∫—É—Ä—Å–∞
- **Bloom's level** –∫–∞–∫ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π constraint
- Structured JSON output –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏

---

### 2.5 FR-005: –ê–≤—Ç–æ-—Ä–∞—Å–∫—Ä—ã—Ç–∏–µ –Ω–æ–¥—ã Stage 4/5

#### –õ–æ–≥–∏–∫–∞

```typescript
// GraphView.tsx
useEffect(() => {
  const awaitingStage = isAwaitingApproval(pipelineStatus);

  // –ê–≤—Ç–æ-–æ—Ç–∫—Ä—ã—Ç–∏–µ –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ Stage 3, 4 –∏–ª–∏ 5
  if (awaitingStage === 3 || awaitingStage === 4 || awaitingStage === 5) {
    selectNode(`stage_${awaitingStage}`);
  }

  // –¢–∞–∫–∂–µ –æ—Ç–∫—Ä—ã–≤–∞—Ç—å –ø—Ä–∏ —Å—Ç–∞—Ç—É—Å–µ 'completed' –¥–ª—è Stage 4/5
  if (stageStatus === 'completed' && [4, 5].includes(stageNumber)) {
    selectNode(`stage_${stageNumber}`);
  }
}, [pipelineStatus, stageStatus]);
```

#### –ü–ª–∞–≤–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è

- Drawer –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Å –∞–Ω–∏–º–∞—Ü–∏–µ–π slide-in —Å–ø—Ä–∞–≤–∞
- –ö–æ–Ω—Ç–µ–Ω—Ç –ø–æ—è–≤–ª—è–µ—Ç—Å—è —Å fade-in –ø–æ—Å–ª–µ –æ—Ç–∫—Ä—ã—Ç–∏—è drawer
- –§–æ–∫—É—Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞ –ø–µ—Ä–≤–æ–º —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º–æ–º –ø–æ–ª–µ

---

### 2.6 FR-006: –û–±—â–∏–π —á–∞—Ç –≤ –Ω–∏–∂–Ω–µ–π —á–∞—Å—Ç–∏ –ø–∞–Ω–µ–ª–∏

–°–æ—Ö—Ä–∞–Ω—è–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π `RefinementChat`, –Ω–æ:
- –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —Ä–∞—Å–∫—Ä—ã—Ç (–Ω–µ —Å–≤—ë—Ä–Ω—É—Ç)
- –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–¥—Å–∫–∞–∑–∫—É: "–ó–∞–¥–∞–π—Ç–µ –≤–æ–ø—Ä–æ—Å –∏–ª–∏ –ø–æ–ø—Ä–æ—Å–∏—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –≤–µ—Å—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç"

---

### 2.7 FR-007: Tiered Context Strategy –¥–ª—è –ø–µ—Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏

> **–ò—Å—Ç–æ—á–Ω–∏–∫:** Research ‚Äî "Lost in the Middle" phenomenon, token budget optimization

#### –£—Ä–æ–≤–Ω–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —É—Ä–æ–≤–µ–Ω—å –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–∏–ø–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

| Tier | –ö–æ–Ω—Ç–µ–Ω—Ç | –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å | –¢–æ–∫–µ–Ω—ã |
|------|---------|-------------------|--------|
| **Tier 1: Atomic** | Target block + 1 prev/next | –û–ø–µ—á–∞—Ç–∫–∏, –º–µ–ª–∫–∏–µ –ø—Ä–∞–≤–∫–∏ | 200-500 |
| **Tier 2: Local** | Tier 1 + –∑–∞–≥–æ–ª–æ–≤–∫–∏ —Å–µ–∫—Ü–∏–∏ | –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ, —Ç–æ–Ω | 500-1,000 |
| **Tier 3: Structural** | Tier 2 + Learning Objectives + Summary | –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–π, —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ | 1,000-2,000 |
| **Tier 4: Global** | Tier 3 + Style Guide + Glossary + Assessments | –ö—Ä—É–ø–Ω—ã–µ –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞–Ω–∏—è | 2,000-5,000+ |

#### Smart Context Router

–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä (–º–∞–ª–µ–Ω—å–∫–∞—è –±—ã—Å—Ç—Ä–∞—è –º–æ–¥–µ–ª—å) –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –ø—Ä–æ–º–ø—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
- "–ò—Å–ø—Ä–∞–≤—å –æ–ø–µ—á–∞—Ç–∫—É" ‚Üí **Tier 1**
- "–°–¥–µ–ª–∞–π –ø–æ–Ω—è—Ç–Ω–µ–µ" ‚Üí **Tier 2**
- "–ò–∑–º–µ–Ω–∏ —Å–ª–æ–∂–Ω–æ—Å—Ç—å –Ω–∞ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π —É—Ä–æ–≤–µ–Ω—å" ‚Üí **Tier 3**
- "–ü–µ—Ä–µ–ø–∏—à–∏ —Å —É—á—ë—Ç–æ–º –Ω–æ–≤–æ–≥–æ —Å—Ç–∏–ª—è" ‚Üí **Tier 4**

#### Token Budget Allocation (8K window)

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ System prompt + instructions         ‚îÇ 10-15% (800-1,200) ‚îÇ
‚îÇ Target content + immediate context   ‚îÇ 40-50% (3,200-4,000) ‚îÇ
‚îÇ Supporting context (summaries)       ‚îÇ 20-30% (1,600-2,400) ‚îÇ
‚îÇ Few-shot style examples              ‚îÇ 10-15% (800-1,200) ‚îÇ
‚îÇ Output buffer                        ‚îÇ 5-10% (400-800)    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

#### Context Caching

–°—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç (Style Guide, Audience Profile, —Å–ø–∏—Å–æ–∫ LO) –∫–µ—à–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ API:
- –ü–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å: –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç
- –ü–æ—Å–ª–µ–¥—É—é—â–∏–µ: —Ç–æ–ª—å–∫–æ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç
- **–≠–∫–æ–Ω–æ–º–∏—è:** –¥–æ 50% —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –∏ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ —Å–Ω–∏–∂–µ–Ω–∏–µ latency

---

### 2.8 FR-008: Dependency Graph –∏ Stale Data Indicators

> **–ò—Å—Ç–æ—á–Ω–∏–∫:** Research ‚Äî Constructive Alignment Theory, PatternFly Stale Data patterns

#### –ì—Ä–∞—Ñ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (Curriculum DAG)

```
Course Learning Outcomes
    ‚Üì maps_to
Module Objectives (Terminal Objectives)
    ‚Üì maps_to
Lesson Objectives (Enabling Objectives)
    ‚Üì drives
Content + Activities + Assessments
```

**–¢–∏–ø—ã —Å–≤—è–∑–µ–π:**
- `PARENT_OF` ‚Äî —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–∞—è –∏–µ—Ä–∞—Ä—Ö–∏—è (Unit ‚Üí Lesson)
- `ALIGNS_TO` ‚Äî –ø–µ–¥–∞–≥–æ–≥–∏—á–µ—Å–∫–æ–µ –≤—ã—Ä–∞–≤–Ω–∏–≤–∞–Ω–∏–µ (Content ‚Üí LO)
- `ASSESSES` ‚Äî –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è (Assessment ‚Üí LO)
- `PREREQUISITE_FOR` ‚Äî –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å (Lesson 1 ‚Üí Lesson 2)

#### Stale Data Indicator

–ö–æ–≥–¥–∞ upstream-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –∏–∑–º–µ–Ω—è–µ—Ç—Å—è, downstream-—ç–ª–µ–º–µ–Ω—Ç—ã –ø–æ–º–µ—á–∞—é—Ç—Å—è –∫–∞–∫ "potentially stale":

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ ‚ö†Ô∏è –£—Ä–æ–∫ 2.3: –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏              [Sync] ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ Learning Objective –∏–∑–º–µ–Ω—ë–Ω 5 –º–∏–Ω –Ω–∞–∑–∞–¥.                ‚îÇ
‚îÇ –ö–æ–Ω—Ç–µ–Ω—Ç –º–æ–∂–µ—Ç –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å –Ω–æ–≤—ã–º —Ü–µ–ª—è–º.         ‚îÇ
‚îÇ                                                         ‚îÇ
‚îÇ [–û–±–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç] [–ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å] [–ü–æ–¥—Ä–æ–±–Ω–µ–µ...]       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–í–∏–∑—É–∞–ª—å–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã:**
- üü¢ –ó–µ–ª—ë–Ω–∞—è –≥—Ä–∞–Ω–∏—Ü–∞ ‚Äî –∞–∫—Ç—É–∞–ª—å–Ω–æ, aligned
- üü° –ñ—ë–ª—Ç–∞—è –≥—Ä–∞–Ω–∏—Ü–∞ + ‚ö†Ô∏è ‚Äî –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ —É—Å—Ç–∞—Ä–µ–ª–æ
- üî¥ –ö—Ä–∞—Å–Ω–∞—è –≥—Ä–∞–Ω–∏—Ü–∞ + ‚ùå ‚Äî —Ç–æ—á–Ω–æ –Ω–µ aligned (Bloom's level mismatch)

---

### 2.9 FR-009: Impact Analysis Modal

> **–ò—Å—Ç–æ—á–Ω–∏–∫:** Research ‚Äî Cascading UX patterns, Mailchimp/GitHub danger zones

#### –¢—Ä–∏–≥–≥–µ—Ä

–û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ **—Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–∞–ª—å–Ω–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞** (Learning Objective, Recommended Structure, Pedagogical Strategy):

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ ‚ö†Ô∏è –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∑–∞—Ç—Ä–æ–Ω–µ—Ç –∑–∞–≤–∏—Å–∏–º—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã              ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                         ‚îÇ
‚îÇ –í—ã –∏–∑–º–µ–Ω—è–µ—Ç–µ: Learning Objective "–ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å..."    ‚îÇ
‚îÇ                                                         ‚îÇ
‚îÇ –≠—Ç–æ –ø–æ–≤–ª–∏—è–µ—Ç –Ω–∞:                                        ‚îÇ
‚îÇ   ‚Ä¢ 3 —É—Ä–æ–∫–∞ –≤ —Å–µ–∫—Ü–∏–∏ "–û—Å–Ω–æ–≤—ã"                          ‚îÇ
‚îÇ   ‚Ä¢ 2 –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è                          ‚îÇ
‚îÇ   ‚Ä¢ 1 –ø—Ä–æ–≤–µ—Ä–æ—á–Ω—ã–π —Ç–µ—Å—Ç (5 –≤–æ–ø—Ä–æ—Å–æ–≤)                    ‚îÇ
‚îÇ                                                         ‚îÇ
‚îÇ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ‚îÇ
‚îÇ                                                         ‚îÇ
‚îÇ –í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ:                                      ‚îÇ
‚îÇ                                                         ‚îÇ
‚îÇ ‚óã –û–±–Ω–æ–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ —Ü–µ–ª—å                                 ‚îÇ
‚îÇ   (–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –±—É–¥—É—Ç –ø–æ–º–µ—á–µ–Ω—ã –∫–∞–∫ —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ)          ‚îÇ
‚îÇ                                                         ‚îÇ
‚îÇ ‚óã –û–±–Ω–æ–≤–∏—Ç—å –≤—Å—ë –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏                           ‚îÇ
‚îÇ   (AI –ø–µ—Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∑–∞–≤–∏—Å–∏–º—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç)                ‚îÇ
‚îÇ                                                         ‚îÇ
‚îÇ ‚óã –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç                             ‚îÇ
‚îÇ   (–ü–æ—à–∞–≥–æ–≤—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä —Å Accept/Skip/Edit)              ‚îÇ
‚îÇ                                                         ‚îÇ
‚îÇ                          [–û—Ç–º–µ–Ω–∞]  [–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å]        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

#### Graduated Warning Severity

| –£—Ä–æ–≤–µ–Ω—å | –¢—Ä–∏–≥–≥–µ—Ä | UI |
|---------|---------|-----|
| **Low** | –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ | Inline toast + Undo (5 —Å–µ–∫) |
| **Medium** | –ò–∑–º–µ–Ω–µ–Ω–∏–µ Lesson Objective | Modal —Å affected items + counts |
| **High** | –ò–∑–º–µ–Ω–µ–Ω–∏–µ Module/Course Objective | Danger zone (–∫—Ä–∞—Å–Ω–∞—è –≥—Ä–∞–Ω–∏—Ü–∞) + typing confirmation |

---

### 2.10 FR-010: Semantic Diffing

> **–ò—Å—Ç–æ—á–Ω–∏–∫:** Research ‚Äî Visual diff systems for AI edits

#### –ö–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω—ã–π diff –≤–º–µ—Å—Ç–æ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ

–ü–æ—Å–ª–µ –ø–µ—Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º **—á—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å –∫–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω–æ**, –∞ –Ω–µ –ø–æ—Å–∏–º–≤–æ–ª—å–Ω–æ:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ ‚ú® –ë–ª–æ–∫ –ø–µ—Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω                                 ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ –ò–∑–º–µ–Ω–µ–Ω–∏—è:                                              ‚îÇ
‚îÇ ‚Ä¢ –£–ø—Ä–æ—â—ë–Ω —è–∑—ã–∫ (—É—Ä–æ–≤–µ–Ω—å: intermediate ‚Üí beginner)      ‚îÇ
‚îÇ ‚Ä¢ –î–æ–±–∞–≤–ª–µ–Ω–∞ –∞–Ω–∞–ª–æ–≥–∏—è: "–∫–∞–∫ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ –¥–æ–º–∞"         ‚îÇ
‚îÇ ‚Ä¢ –£–¥–∞–ª—ë–Ω —Ç–µ—Ä–º–∏–Ω: "–¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—è"                        ‚îÇ
‚îÇ ‚Ä¢ –î–æ–±–∞–≤–ª–µ–Ω –ø—Ä–∏–º–µ—Ä: –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –≤ –±–∏–∑–Ω–µ—Å–µ   ‚îÇ
‚îÇ                                                         ‚îÇ
‚îÇ Alignment Score: 4/5 ‚≠ê                                 ‚îÇ
‚îÇ (–°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç Learning Objective –Ω–∞ 80%)              ‚îÇ
‚îÇ                                                         ‚îÇ
‚îÇ             [–ü—Ä–∏–Ω—è—Ç—å] [–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å] [–û—Ç–º–µ–Ω–∏—Ç—å]       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

#### JSON Response Schema –¥–ª—è LLM

```typescript
interface RegenerationResponse {
  regenerated_content: string;          // Markdown
  pedagogical_change_log: string;       // –û–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
  alignment_score: 1 | 2 | 3 | 4 | 5;  // –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ LO
  bloom_level_preserved: boolean;       // –°–æ—Ö—Ä–∞–Ω—ë–Ω –ª–∏ —É—Ä–æ–≤–µ–Ω—å Bloom
  suggested_glossary_terms: string[];   // –ù–æ–≤—ã–µ —Ç–µ—Ä–º–∏–Ω—ã
  concepts_added: string[];             // –î–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏
  concepts_removed: string[];           // –£–¥–∞–ª—ë–Ω–Ω—ã–µ –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏
}
```

---

## 3. –ù–µ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### 3.1 NFR-001: –ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å —Å—Ç–∏–ª—è

- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏–∑ `@/components/ui/`
- –¶–≤–µ—Ç–æ–≤–∞—è —Å—Ö–µ–º–∞: —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ `NODE_STYLES` –∏–∑ generation-graph
- –¢–∏–ø–æ–≥—Ä–∞—Ñ–∏–∫–∞: Tailwind utilities (`text-sm`, `font-medium`, etc.)
- –ò–∫–æ–Ω–∫–∏: Lucide React (—É–∂–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è)

### 3.2 NFR-002: –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è

–í—Å–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —Å—Ç—Ä–æ–∫–∏ –¥–æ–±–∞–≤–∏—Ç—å –≤:
- `packages/web/lib/generation-graph/translations.ts`
- –Ø–∑—ã–∫–∏: RU (–æ—Å–Ω–æ–≤–Ω–æ–π), EN (fallback)

### 3.3 NFR-003: –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

- Lazy-loading —Å–µ–∫—Ü–∏–π (Accordion)
- Virtualization –¥–ª—è —Å–ø–∏—Å–∫–æ–≤ > 20 —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- –ú–µ–º–æ–∏–∑–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### 3.4 NFR-004: –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å (a11y)

- Keyboard navigation (Tab, Enter, Escape)
- ARIA-labels –¥–ª—è –≤—Å–µ—Ö –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- Focus management –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ —Ä–µ–∂–∏–º–æ–≤

---

## 4. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –¥–∏–∑–∞–π–Ω

### 4.0 –ê–Ω–∞–ª–∏–∑ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

> **–ü—Ä–∏–Ω—Ü–∏–ø:** –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –∑–∞–¥–∞—á–∏.

#### –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º (–æ–ø—Ç–∏–º–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥—è—Ç):

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ü–æ—á–µ–º—É –ø–æ–¥—Ö–æ–¥–∏—Ç | –ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º |
|-----------|-----------------|----------------|
| `Card` | –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏ –≤–µ—Ä–Ω–æ –¥–ª—è –±–ª–æ–∫–æ–≤ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ | –°–µ–∫—Ü–∏–∏ –≤ AnalysisResultView |
| `Accordion` | –ò–µ—Ä–∞—Ä—Ö–∏—è Phase ‚Üí Content | PhaseAccordion |
| `Badge` | –°—Ç–∞—Ç—É—Å—ã, —Ç–µ–≥–∏ ‚Äî —Ç–æ—á–Ω–æ–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ | Stale indicators, —É—Ä–æ–≤–Ω–∏ Bloom |
| `Dialog` | –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –±–∞–∑–∞ –¥–ª—è –º–æ–¥–∞–ª–æ–∫ | ImpactAnalysisModal |
| `Sheet` | NodeDetailsDrawer —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç | –°–æ—Ö—Ä–∞–Ω—è–µ–º |
| `Sonner` | Toast —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è | SaveStatusIndicator |
| `Button`, `Select` | –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ controls | –í–µ–∑–¥–µ |

#### –ù–ï –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º (–Ω–µ –ø–æ–¥—Ö–æ–¥—è—Ç):

| –¢–µ–∫—É—â–∏–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç | –ü—Ä–æ–±–ª–µ–º–∞ | –ù–æ–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ |
|-------------------|----------|---------------|
| `JsonViewer` | –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π JSON –≤–∏–¥ | `AnalysisResultView` / `CourseStructureView` |
| `AttemptSelector` | "Attempt 1, 2, 3" –Ω–µ–ø–æ–Ω—è—Ç–Ω–æ | `PhaseSelector` —Å —Å–µ–º–∞–Ω—Ç–∏–∫–æ–π |
| `FormField` | –î–ª—è —Ñ–æ—Ä–º, –Ω–µ –¥–ª—è inline edit | `EditableField` —Å hover-to-edit |
| `Badge` (read-only) | –ù–µ–ª—å–∑—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å | `EditableChips` |
| `RefinementChat` | –û–±—â–∏–π –¥–ª—è stage, –Ω–µ –¥–ª—è –±–ª–æ–∫–∞ | `InlineRegenerateChat` –ø—Ä–∏–≤—è–∑–∞–Ω –∫ –±–ª–æ–∫—É |

### 4.1 –ù–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

```
packages/web/components/generation-graph/panels/
‚îú‚îÄ‚îÄ OutputTab.tsx                    # –†–ï–§–ê–ö–¢–û–†–ò–ù–ì: —É—Å–ª–æ–≤–Ω—ã–π —Ä–µ–Ω–¥–µ—Ä View –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
‚îú‚îÄ‚îÄ output/
‚îÇ   ‚îú‚îÄ‚îÄ AnalysisResultView.tsx       # –ù–û–í–´–ô: Stage 4 human-readable (–∑–∞–º–µ–Ω—è–µ—Ç JsonViewer)
‚îÇ   ‚îú‚îÄ‚îÄ CourseStructureView.tsx      # –ù–û–í–´–ô: Stage 5 human-readable (–∑–∞–º–µ–Ω—è–µ—Ç JsonViewer)
‚îÇ   ‚îú‚îÄ‚îÄ EditableField.tsx            # –ù–û–í–´–ô: inline edit —Å hover (FormField –Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç)
‚îÇ   ‚îú‚îÄ‚îÄ EditableChips.tsx            # –ù–û–í–´–ô: add/remove chips (Badge read-only)
‚îÇ   ‚îú‚îÄ‚îÄ InlineRegenerateChat.tsx     # –ù–û–í–´–ô: mini-chat –ø—Ä–∏–≤—è–∑–∞–Ω –∫ –±–ª–æ–∫—É
‚îÇ   ‚îú‚îÄ‚îÄ PhaseAccordion.tsx           # –ù–û–í–´–ô: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Accordion –∫–∞–∫ –±–∞–∑—É
‚îÇ   ‚îú‚îÄ‚îÄ SaveStatusIndicator.tsx      # –ù–û–í–´–ô: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Sonner –¥–ª—è toast
‚îÇ   ‚îú‚îÄ‚îÄ SemanticDiff.tsx             # –ù–û–í–´–ô: conceptual diff (Research)
‚îÇ   ‚îú‚îÄ‚îÄ StaleDataIndicator.tsx       # –ù–û–í–´–ô: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Badge + Alert (Research)
‚îÇ   ‚îî‚îÄ‚îÄ ImpactAnalysisModal.tsx      # –ù–û–í–´–ô: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Dialog –∫–∞–∫ –±–∞–∑—É (Research)
‚îú‚îÄ‚îÄ PhaseSelector.tsx                # –ù–û–í–´–ô: –∑–∞–º–µ–Ω—è–µ—Ç AttemptSelector
‚îî‚îÄ‚îÄ phase-names.ts                   # –ù–û–í–´–ô: –ø–µ—Ä–µ–≤–æ–¥—ã –Ω–∞–∑–≤–∞–Ω–∏–π —Ñ–∞–∑

packages/course-gen-platform/src/shared/regeneration/
‚îú‚îÄ‚îÄ smart-context-router.ts          # –ù–û–í–´–ô: Tiered Context Strategy (Research)
‚îú‚îÄ‚îÄ context-assembler.ts             # –ù–û–í–´–ô: —Å–±–æ—Ä–∫–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –ø–æ Tier
‚îú‚îÄ‚îÄ bloom-validator.ts               # –ù–û–í–´–ô: –≤–∞–ª–∏–¥–∞—Ü–∏—è Bloom's level
‚îî‚îÄ‚îÄ semantic-diff-generator.ts       # –ù–û–í–´–ô: –≥–µ–Ω–µ—Ä–∞—Ü–∏—è conceptual diff

packages/course-gen-platform/src/stages/stage5-generation/utils/
‚îî‚îÄ‚îÄ course-structure-editor.ts       # –ù–û–í–´–ô: PATCH –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π —Å –ø–µ—Ä–µ—Å—á—ë—Ç–æ–º
```

### 4.1.1 –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è (–≤—ã—è–≤–ª–µ–Ω—ã –ø—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ)

**–í—ã—á–∏—Å–ª—è–µ–º—ã–µ –ø–æ–ª—è —Ç—Ä–µ–±—É—é—Ç –ø–µ—Ä–µ—Å—á—ë—Ç–∞:**
```typescript
// Section.estimated_duration_minutes = —Å—É–º–º–∞ lesson durations
// –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ lesson.estimated_duration_minutes –Ω—É–∂–Ω–æ:
// 1. –ü–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å section.estimated_duration_minutes
// 2. –ü–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å course.estimated_duration_hours

// lesson_number ‚Äî –≥–ª–æ–±–∞–ª—å–Ω–∞—è –Ω—É–º–µ—Ä–∞—Ü–∏—è
// –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏/—É–¥–∞–ª–µ–Ω–∏–∏ lesson –Ω—É–∂–Ω–æ:
// 1. –ü–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å lesson_number –¥–ª—è –≤—Å–µ—Ö –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö lessons
```

**–ú–∏–Ω–∏–º—É–º 10 —É—Ä–æ–∫–æ–≤ (FR-015):**
- –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–∏ –ª—é–±–æ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
- –ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å —É–¥–∞–ª–µ–Ω–∏–µ –µ—Å–ª–∏ –æ—Å—Ç–∞–Ω–µ—Ç—Å—è < 10

### 4.2 API –∏–∑–º–µ–Ω–µ–Ω–∏—è

#### –ù–æ–≤—ã–π endpoint –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ–ª–µ–π

```typescript
// packages/course-gen-platform/src/server/routers/generation.ts

// –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –ø–æ–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
generation.updateField = t.procedure
  .input(z.object({
    courseId: z.string().uuid(),
    stageId: z.enum(['stage_4', 'stage_5']),
    fieldPath: z.string(), // e.g., "topic_analysis.key_concepts"
    value: z.unknown(),
  }))
  .mutation(async ({ input }) => {
    // 1. –ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏–∑ –ë–î
    // 2. –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –ø–æ–ª–µ (lodash.set)
    // 3. –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –ë–î
    // 4. –í–µ—Ä–Ω—É—Ç—å –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç
  });

// –ü–µ—Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –±–ª–æ–∫–∞ (Research: Tiered Context + Semantic Diff)
generation.regenerateBlock = t.procedure
  .input(z.object({
    courseId: z.string().uuid(),
    stageId: z.enum(['stage_4', 'stage_5']),
    blockPath: z.string(), // e.g., "topic_analysis.key_concepts"
    userInstruction: z.string(),
  }))
  .mutation(async ({ input }) => {
    // 1. Smart Context Router –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç Tier (1-4)
    // 2. Context Assembler —Å–æ–±–∏—Ä–∞–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –ø–æ Tier
    // 3. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è XML-structured prompt
    // 4. –í—ã–∑–æ–≤ LLM —Å JSON output schema
    // 5. –í–∞–ª–∏–¥–∞—Ü–∏—è Bloom's level preserved
    // 6. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è Semantic Diff
    // 7. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î
    // 8. –í–æ–∑–≤—Ä–∞—Ç RegenerationResponse
  });

// –ü–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –±–ª–æ–∫–∞ (Research: Dependency Graph)
generation.getBlockDependencies = t.procedure
  .input(z.object({
    courseId: z.string().uuid(),
    blockPath: z.string(),
  }))
  .query(async ({ input }) => {
    // 1. –ü–æ–ª—É—á–∏—Ç—å upstream –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (–æ—Ç —á–µ–≥–æ –∑–∞–≤–∏—Å–∏—Ç)
    // 2. –ü–æ–ª—É—á–∏—Ç—å downstream –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (—á—Ç–æ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —ç—Ç–æ–≥–æ)
    // 3. –í–µ—Ä–Ω—É—Ç—å –≥—Ä–∞—Ñ —Å counts
  });

// –ö–∞—Å–∫–∞–¥–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (Research: Impact Analysis)
generation.cascadeUpdate = t.procedure
  .input(z.object({
    courseId: z.string().uuid(),
    blockPath: z.string(),
    mode: z.enum(['mark_stale', 'auto_regenerate', 'review_each']),
  }))
  .mutation(async ({ input }) => {
    // 1. –ü–æ–ª—É—á–∏—Ç—å downstream –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
    // 2. –í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç mode:
    //    - mark_stale: –ø–æ–º–µ—Ç–∏—Ç—å –∫–∞–∫ —É—Å—Ç–∞—Ä–µ–≤—à–∏–µ
    //    - auto_regenerate: –ø–µ—Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ
    //    - review_each: –≤–µ—Ä–Ω—É—Ç—å —Å–ø–∏—Å–æ–∫ –¥–ª—è –ø–æ—à–∞–≥–æ–≤–æ–≥–æ review
  });
```

### 4.3 –°—Ö–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö

–ë–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –ë–î. –°–æ—Ö—Ä–∞–Ω—è–µ–º JSONB –≤:
- `courses.analysis_result` (Stage 4)
- `courses.course_structure` (Stage 5)

---

## 5. –ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è –∑–∞–¥–∞—á

### Pre-req: Production-readiness –±–ª–æ–∫–µ—Ä—ã

| ID | –ó–∞–¥–∞—á–∞ | –û—Ü–µ–Ω–∫–∞ |
|----|--------|--------|
| T0.1 | AbortController –≤ useRefinement.ts | 1—á |
| T0.2 | Zod –≤–∞–ª–∏–¥–∞—Ü–∏—è API responses –Ω–∞ frontend | 2—á |

**–ò—Ç–æ–≥–æ pre-req:** 3—á (–≤—ã–ø–æ–ª–Ω–∏—Ç—å –î–û –æ—Å–Ω–æ–≤–Ω—ã—Ö –∑–∞–¥–∞—á)

### P0: –ö—Ä–∏—Ç–∏—á–Ω—ã–π (MVP)

| ID | –ó–∞–¥–∞—á–∞ | –û—Ü–µ–Ω–∫–∞ |
|----|--------|--------|
| T1 | PhaseSelector —Å —á–µ–ª–æ–≤–µ–∫–æ-–ø–æ–Ω—è—Ç–Ω—ã–º–∏ –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏ | 2—á |
| T2 | AnalysisResultView ‚Äî –±–∞–∑–æ–≤–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ + skeleton loading | 4—á |
| T3 | CourseStructureView ‚Äî –±–∞–∑–æ–≤–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ + skeleton loading | 4—á |
| T4 | –ê–≤—Ç–æ-—Ä–∞—Å–∫—Ä—ã—Ç–∏–µ Stage 4/5 + Zod parse traces | 1—á |

### P1: –í–∞–∂–Ω—ã–π (–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)

| ID | –ó–∞–¥–∞—á–∞ | –û—Ü–µ–Ω–∫–∞ |
|----|--------|--------|
| T5 | EditableField –∫–æ–º–ø–æ–Ω–µ–Ω—Ç | 3—á |
| T6 | –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å debounce + SaveStatusIndicator + **optimistic UI** | 3—á |
| T7 | API endpoint generation.updateField | 2—á |
| T8 | EditableChips –∫–æ–º–ø–æ–Ω–µ–Ω—Ç | 2—á |

### P2: –í–∞–∂–Ω—ã–π (–ü–µ—Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è ‚Äî –∏–∑ Research)

| ID | –ó–∞–¥–∞—á–∞ | –û—Ü–µ–Ω–∫–∞ |
|----|--------|--------|
| T9 | InlineRegenerateChat —Å XML-structured prompts + **exponential backoff** | 6—á |
| T10 | API endpoint generation.regenerateBlock | 3—á |
| T11 | Smart Context Router (Tiered Strategy) | 4—á |
| T12 | Quick Actions —Å Bloom's level validation | 2—á |
| T13 | Semantic Diffing UI (concepts added/removed) + **Sentry logging** | 4—á |

### P3: –í–∞–∂–Ω—ã–π (–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ ‚Äî –∏–∑ Research)

| ID | –ó–∞–¥–∞—á–∞ | –û—Ü–µ–Ω–∫–∞ |
|----|--------|--------|
| T14 | Dependency Graph schema (Curriculum DAG) | 4—á |
| T15 | Stale Data Indicators UI | 3—á |
| T16 | Impact Analysis Modal | 4—á |
| T17 | Graduated Warning System (Low/Medium/High) | 2—á |

### P4: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

| ID | –ó–∞–¥–∞—á–∞ | –û—Ü–µ–Ω–∫–∞ |
|----|--------|--------|
| T18 | Context Caching –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ | 3—á |
| T19 | Virtualization –¥–ª—è –¥–ª–∏–Ω–Ω—ã—Ö —Å–ø–∏—Å–∫–æ–≤ | 2—á |
| T20 | Undo/Redo –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è | 3—á |
| T21 | Keyboard shortcuts | 2—á |

### –°–≤–æ–¥–∫–∞

| –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –ó–∞–¥–∞—á–∏ | –ß–∞—Å–æ–≤ |
|-----------|--------|-------|
| P0 (MVP) | T1-T4 | 11—á |
| P1 (–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ) | T5-T8 | 9—á |
| P2 (–ü–µ—Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è) | T9-T13 | 17—á |
| P3 (–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏) | T14-T17 | 13—á |
| P4 (–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è) | T18-T21 | 10—á |
| **–ò—Ç–æ–≥–æ** | 21 –∑–∞–¥–∞—á–∞ | **60—á** |

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ —Ñ–∞–∑—ã –≤–Ω–µ–¥—Ä–µ–Ω–∏—è

**–§–∞–∑–∞ 1 (P0 + P1):** –ë–∞–∑–æ–≤—ã–π UI + —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Äî **20—á**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç –ø–æ–Ω—è—Ç–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
- –ú–æ–∂–µ—Ç —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å

**–§–∞–∑–∞ 2 (P2):** –ü–µ—Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å AI ‚Äî **17—á**
- Inline-—á–∞—Ç —Å –º–æ–¥–µ–ª—å—é
- Smart Context –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ —Ç–æ–∫–µ–Ω–æ–≤
- Semantic Diffing –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

**–§–∞–∑–∞ 3 (P3):** Dependency Management ‚Äî **13—á**
- –ì—Ä–∞—Ñ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- Stale indicators
- Impact Analysis

**–§–∞–∑–∞ 4 (P4):** Polish ‚Äî **10—á**
- –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- UX-—É–ª—É—á—à–µ–Ω–∏—è

---

## 6. Acceptance Criteria

### AC-001: –ü–æ–Ω—è—Ç–Ω–æ—Å—Ç—å –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

- [ ] –ù–µ—Ç —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —Ç–µ—Ä–º–∏–Ω–æ–≤ —Ç–∏–ø–∞ "Attempt", "JSON", "phase"
- [ ] –í—Å–µ –Ω–∞–∑–≤–∞–Ω–∏—è –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ
- [ ] –û–ø–∏—Å–∞–Ω–∏–µ –∫–∞–∂–¥–æ–π —Å–µ–∫—Ü–∏–∏ –æ–±—ä—è—Å–Ω—è–µ—Ç –µ—ë –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ

### AC-002: –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

- [ ] –í—Å–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –ø–æ–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–µ–º—ã
- [ ] –°–ø–∏—Å–∫–∏ (chips) –ø–æ–∑–≤–æ–ª—è—é—Ç –¥–æ–±–∞–≤–ª—è—Ç—å/—É–¥–∞–ª—è—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã
- [ ] Enum-–ø–æ–ª—è –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –ø–æ–Ω—è—Ç–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã (–Ω–µ –∫–æ–¥—ã)

### AC-003: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ

- [ ] –ò–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ 1 —Å–µ–∫ –ø–æ—Å–ª–µ –≤–≤–æ–¥–∞
- [ ] –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä "–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ..." ‚Üí "–°–æ—Ö—Ä–∞–Ω–µ–Ω–æ"
- [ ] –ü—Ä–∏ –ø–æ—Ç–µ—Ä–µ —Ñ–æ–∫—É—Å–∞ ‚Äî –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ

### AC-004: –ü–µ—Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è

- [ ] –ö–Ω–æ–ø–∫–∞ [üîÑ] –¥–æ—Å—Ç—É–ø–Ω–∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –±–ª–æ–∫–∞
- [ ] Mini-chat –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø–æ–¥ –±–ª–æ–∫–æ–º
- [ ] Quick Actions —Ä–∞–±–æ—Ç–∞—é—Ç –æ–¥–Ω–∏–º –∫–ª–∏–∫–æ–º
- [ ] –†–µ–∑—É–ª—å—Ç–∞—Ç –ø–µ—Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –º–æ–∂–Ω–æ –ø—Ä–∏–Ω—è—Ç—å –∏–ª–∏ –æ—Ç–º–µ–Ω–∏—Ç—å

### AC-005: –ê–≤—Ç–æ-—Ä–∞—Å–∫—Ä—ã—Ç–∏–µ

- [ ] Stage 4 –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ —Å—Ç–∞—Ç—É—Å–µ 'completed'
- [ ] Stage 5 –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ —Å—Ç–∞—Ç—É—Å–µ 'completed'
- [ ] –ü–ª–∞–≤–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è –æ—Ç–∫—Ä—ã—Ç–∏—è

### AC-006: Tiered Context (–∏–∑ Research)

- [ ] Smart Context Router –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —É—Ä–æ–≤–µ–Ω—å –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- [ ] Tier 1-4 –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ä–∞–∑–Ω—ã–π –æ–±—ä—ë–º —Ç–æ–∫–µ–Ω–æ–≤
- [ ] Context Caching —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö

### AC-007: Dependency Management (–∏–∑ Research)

- [ ] Stale Data Indicator –ø–æ—è–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ upstream-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
- [ ] Impact Analysis Modal –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç affected elements —Å counts
- [ ] –¢—Ä–∏ –≤–∞—Ä–∏–∞–Ω—Ç–∞: Update only / Update all / Review each

### AC-008: Semantic Diffing (–∏–∑ Research)

- [ ] –ü–æ—Å–ª–µ –ø–µ—Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è conceptual diff
- [ ] Alignment Score –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è (1-5)
- [ ] Concepts added/removed –≤–∏–¥–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
- [ ] Bloom's level preserved/changed –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä

---

## 7. –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

> –†–µ–∑—É–ª—å—Ç–∞—Ç code review —Å—É–±–∞–≥–µ–Ω—Ç–∞–º–∏

### 7.1 –ß—Ç–æ —Ö–æ—Ä–æ—à–æ –≤ —Ç–µ–∫—É—â–µ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ

| –ê—Å–ø–µ–∫—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|----------|
| **NodeDetailsDrawer** | –•–æ—Ä–æ—à–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω, 4 —Ç–∞–±–∞, –Ω–∏–∑–∫–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ |
| **Zustand store** | `useNodeSelection` ‚Äî —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—ã–±–æ—Ä–æ–º —É–∑–ª–∞ |
| **JsonViewer** | –ú–æ—â–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π, syntax highlighting, –∞–Ω–∏–º–∞—Ü–∏—è–º–∏ (–Ω–æ –Ω–µ –¥–ª—è users) |
| **UnifiedRegenerator** | 5-—Å–ª–æ–π–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è JSON, production-ready |
| **Type safety** | –•–æ—Ä–æ—à–∞—è —Ç–∏–ø–∏–∑–∞—Ü–∏—è —Å TraceAttempt, ProcessMetrics, AnalysisResult |
| **UI –±–∏–±–ª–∏–æ—Ç–µ–∫–∞** | 95% –±–∞–∑–æ–≤—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã |
| **Section regeneration** | –ê—Ç–æ–º–∞—Ä–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ–∫—Ü–∏–π —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç |

### 7.2 –ß—Ç–æ –ø–ª–æ—Ö–æ / —Ç—Ä–µ–±—É–µ—Ç —É–ª—É—á—à–µ–Ω–∏—è

| –ü—Ä–æ–±–ª–µ–º–∞ | –í–ª–∏—è–Ω–∏–µ | –†–µ—à–µ–Ω–∏–µ –≤ –¢–ó |
|----------|---------|--------------|
| **JsonViewer –¥–ª—è output** | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π JSON | AnalysisResultView / CourseStructureView |
| **"Attempt 1, 2, 3"** | –ù–µ–ø–æ–Ω—è—Ç–Ω–æ —á—Ç–æ —ç—Ç–æ –∑–∞ —ç—Ç–∞–ø—ã | PhaseSelector —Å —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏–º–∏ –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏ |
| **RefinementChat –æ–±—â–∏–π** | –ù–µ–ª—å–∑—è –ø–µ—Ä–µ–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –±–ª–æ–∫ | InlineRegenerateChat –ø—Ä–∏–≤—è–∑–∞–Ω –∫ –±–ª–æ–∫—É |
| **–ù–µ—Ç PATCH –¥–ª—è –ø–æ–ª–µ–π** | –ù–µ–ª—å–∑—è –æ–±–Ω–æ–≤–∏—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ–µ –ø–æ–ª–µ | –ù–æ–≤—ã–π API endpoint generation.updateField |
| **–ù–µ—Ç dependency graph** | –ù–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π | FR-008: Dependency Graph + Stale Indicators |
| **–ê–≤—Ç–æ-–æ—Ç–∫—Ä—ã—Ç–∏–µ —Ç–æ–ª—å–∫–æ Stage 3** | Stage 4/5 —Ç—Ä–µ–±—É—é—Ç —Ä—É—á–Ω–æ–≥–æ –æ—Ç–∫—Ä—ã—Ç–∏—è | FR-005: –ê–≤—Ç–æ-—Ä–∞—Å–∫—Ä—ã—Ç–∏–µ Stage 4/5 |

### 7.3 –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –¢–ó

**–ü–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–≤–º–µ—Å—Ç–∏–º–æ:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Sheet –¥–ª—è drawer (—É–∂–µ —Ç–∞–∫)
- Tabs –≤–Ω—É—Ç—Ä–∏ NodeDetailsDrawer (—É–∂–µ –µ—Å—Ç—å)
- Sonner –¥–ª—è toast —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (—É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω)
- Accordion –¥–ª—è –∏–µ—Ä–∞—Ä—Ö–∏–∏ (–µ—Å—Ç—å –≤ UI kit)

**–¢—Ä–µ–±—É–µ—Ç –Ω–æ–≤—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:**
- Human-readable views –¥–ª—è Stage 4/5 output
- Inline editing —Å –∞–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º
- Block-level regeneration chat
- Semantic diffing UI

**–¢—Ä–µ–±—É–µ—Ç –Ω–æ–≤—ã—Ö API:**
- `generation.updateField` ‚Äî PATCH –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ –ø–æ–ª—è
- `generation.getBlockDependencies` ‚Äî –≥—Ä–∞—Ñ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- `generation.cascadeUpdate` ‚Äî –∫–∞—Å–∫–∞–¥–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

**–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—ã:**
- –í—ã—á–∏—Å–ª—è–µ–º—ã–µ –ø–æ–ª—è (duration) —Ç—Ä–µ–±—É—é—Ç –ø–µ—Ä–µ—Å—á—ë—Ç–∞ –ø—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏
- –ì–ª–æ–±–∞–ª—å–Ω–∞—è –Ω—É–º–µ—Ä–∞—Ü–∏—è lessons —Ç—Ä–µ–±—É–µ—Ç –ø–µ—Ä–µ—Å—á—ë—Ç–∞ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
- –ú–∏–Ω–∏–º—É–º 10 —É—Ä–æ–∫–æ–≤ ‚Äî –≤–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–∏ –ª—é–±–æ–º —É–¥–∞–ª–µ–Ω–∏–∏

---

## 8. Production-Readiness: Pre-requisites

> –†–µ–∑—É–ª—å—Ç–∞—Ç –∞—É–¥–∏—Ç–∞ production-readiness (score: Frontend 65/100, Backend 82/100)

### 8.1 –ò—Å–ø—Ä–∞–≤–∏—Ç—å –î–û –Ω–∞—á–∞–ª–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (–±–ª–æ–∫–µ—Ä—ã)

| –ü—Ä–æ–±–ª–µ–º–∞ | –§–∞–π–ª | –ß—Ç–æ —Å–¥–µ–ª–∞—Ç—å | –û—Ü–µ–Ω–∫–∞ |
|----------|------|-------------|--------|
| **–ù–µ—Ç AbortController** | `useRefinement.ts` | –î–æ–±–∞–≤–∏—Ç—å abort signal –¥–ª—è –æ—Ç–º–µ–Ω—ã –∑–∞–ø—Ä–æ—Å–æ–≤ –ø—Ä–∏ unmount | 1—á |
| **–ù–µ—Ç Zod –¥–ª—è responses** | `generation.ts` router | –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å API responses –Ω–∞ frontend | 2—á |

### 8.2 –ò—Å–ø—Ä–∞–≤–∏—Ç—å –í –†–ê–ú–ö–ê–• –¢–ó (–æ–±—ä–µ–¥–∏–Ω–∏—Ç—å —Å –∑–∞–¥–∞—á–∞–º–∏)

| –ü—Ä–æ–±–ª–µ–º–∞ | –ó–∞–¥–∞—á–∞ –¢–ó | –ö–∞–∫ –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å |
|----------|-----------|----------------|
| –ù–µ—Ç optimistic updates | T6: –ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ | Optimistic UI –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –ø–æ–ª–µ–π |
| –ù–µ—Ç retry —Å backoff | T9: InlineRegenerateChat | Exponential backoff + jitter |
| –ù–µ—Ç Sentry logging | T13: SemanticDiff | –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –æ—à–∏–±–∫–∏ —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ |
| –°–ª–∞–±—ã–µ loading states | T2, T3: Views | Skeleton loading –¥–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞ |
| Realtime traces –Ω–µ –≤–∞–ª–∏–¥–∏—Ä—É—é—Ç—Å—è | T4: –ê–≤—Ç–æ-—Ä–∞—Å–∫—Ä—ã—Ç–∏–µ | Zod parse –ø–µ—Ä–µ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–æ–π |

### 8.3 –ú–æ–∂–Ω–æ –æ—Ç–ª–æ–∂–∏—Ç—å (–Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç)

- Quota check transaction-aware (—Ä–µ–¥–∫–∏–π race)
- Batch rollback –¥–ª—è Stage 6 (–≤–Ω–µ scope)
- Stage-specific retry policies (–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è)
- Full undo/redo history (P4 —É–ª—É—á—à–µ–Ω–∏–µ)

---

## 9. –†–∏—Å–∫–∏ –∏ –º–∏—Ç–∏–≥–∞—Ü–∏–∏

| –†–∏—Å–∫ | –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å | –í–ª–∏—è–Ω–∏–µ | –ú–∏—Ç–∏–≥–∞—Ü–∏—è |
|------|-------------|---------|-----------|
| –°–ª–æ–∂–Ω–æ—Å—Ç—å –ø–∞—Ä—Å–∏–Ω–≥–∞ –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö JSONB | –°—Ä–µ–¥–Ω—è—è | –í—ã—Å–æ–∫–æ–µ | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å lodash.get/set |
| –ü–µ—Ä–µ–≥—Ä—É–∑–∫–∞ UI –¥–ª—è –±–æ–ª—å—à–∏—Ö –∫—É—Ä—Å–æ–≤ | –°—Ä–µ–¥–Ω—è—è | –°—Ä–µ–¥–Ω–µ–µ | Virtualization + Accordion |
| –ö–æ–Ω—Ñ–ª–∏–∫—Ç—ã –ø—Ä–∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–º —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ | –ù–∏–∑–∫–∞—è | –í—ã—Å–æ–∫–æ–µ | Optimistic UI + Last-write-wins |
| LLM latency –ø—Ä–∏ –ø–µ—Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ | –í—ã—Å–æ–∫–∞—è | –°—Ä–µ–¥–Ω–µ–µ | Streaming + skeleton loading |

---

## 8. –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

### –í–Ω–µ—à–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ (—É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã)

- `@radix-ui/react-accordion` ‚Äî –¥–ª—è —Å–µ–∫—Ü–∏–π
- `lodash` ‚Äî –¥–ª—è get/set –ø–æ –ø—É—Ç–∏
- `framer-motion` ‚Äî –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–π
- `lucide-react` ‚Äî –¥–ª—è –∏–∫–æ–Ω–æ–∫

### –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

- `packages/shared-types/src/analysis-result.ts` ‚Äî —Ç–∏–ø—ã Stage 4
- `packages/shared-types/src/generation-result.ts` ‚Äî —Ç–∏–ø—ã Stage 5
- `packages/web/components/ui/` ‚Äî –±–∞–∑–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

---

## 9. –ú–æ–∫–∞–ø—ã

> –ú–æ–∫–∞–ø—ã –±—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã –Ω–∞ —ç—Ç–∞–ø–µ –¥–∏–∑–∞–π–Ω–∞. –†–µ—Ñ–µ—Ä–µ–Ω—Å: Notion blocks, Linear issues editor.

---

## Appendix A: –ü–µ—Ä–µ–≤–æ–¥—ã –Ω–∞–∑–≤–∞–Ω–∏–π —Ñ–∞–∑

```typescript
// packages/web/lib/generation-graph/phase-names.ts

export const PHASE_NAMES = {
  stage_4: {
    phase_0: {
      ru: '–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞',
      en: 'Preparation',
      description: {
        ru: '–ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∫ –∞–Ω–∞–ª–∏–∑—É',
        en: 'Checking document readiness for analysis'
      }
    },
    phase_1: {
      ru: '–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è',
      en: 'Classification',
      description: {
        ru: '–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ —Ç–µ–º—ã –∫—É—Ä—Å–∞',
        en: 'Determining course category and topic'
      }
    },
    phase_2: {
      ru: '–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—ä—ë–º–∞',
      en: 'Scope Planning',
      description: {
        ru: '–†–∞—Å—á—ë—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —É—Ä–æ–∫–æ–≤ –∏ —Å–µ–∫—Ü–∏–π',
        en: 'Calculating lessons and sections count'
      }
    },
    phase_3: {
      ru: '–≠–∫—Å–ø–µ—Ä—Ç–Ω—ã–π –∞–Ω–∞–ª–∏–∑',
      en: 'Expert Analysis',
      description: {
        ru: '–ì–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑ –∏ –≤—ã–±–æ—Ä –ø–µ–¥–∞–≥–æ–≥–∏—á–µ—Å–∫–æ–π —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏',
        en: 'Deep analysis and pedagogical strategy selection'
      }
    },
    phase_4: {
      ru: '–°–∏–Ω—Ç–µ–∑ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤',
      en: 'Document Synthesis',
      description: {
        ru: '–ê–Ω–∞–ª–∏–∑ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –∏ —Å–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π',
        en: 'Analyzing uploaded materials and creating recommendations'
      }
    },
    phase_6: {
      ru: 'RAG-–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ',
      en: 'RAG Planning',
      description: {
        ru: '–°–≤—è–∑—ã–≤–∞–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ —Å —Ä–∞–∑–¥–µ–ª–∞–º–∏ –∫—É—Ä—Å–∞',
        en: 'Mapping documents to course sections'
      }
    },
    phase_5: {
      ru: '–§–∏–Ω–∞–ª–∏–∑–∞—Ü–∏—è',
      en: 'Finalization',
      description: {
        ru: '–°–±–æ—Ä–∫–∞ –∏—Ç–æ–≥–æ–≤–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞',
        en: 'Assembling final analysis result'
      }
    }
  },
  stage_5: {
    validate_input: {
      ru: '–í–∞–ª–∏–¥–∞—Ü–∏—è',
      en: 'Validation',
      description: {
        ru: '–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö',
        en: 'Input data validation'
      }
    },
    generate_metadata: {
      ru: '–ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ',
      en: 'Metadata',
      description: {
        ru: '–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ–ø–∏—Å–∞–Ω–∏—è –∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ –∫—É—Ä—Å–∞',
        en: 'Generating course description and properties'
      }
    },
    generate_sections: {
      ru: '–°—Ç—Ä—É–∫—Ç—É—Ä–∞',
      en: 'Structure',
      description: {
        ru: '–°–æ–∑–¥–∞–Ω–∏–µ —Å–µ–∫—Ü–∏–π –∏ —É—Ä–æ–∫–æ–≤ –∫—É—Ä—Å–∞',
        en: 'Creating course sections and lessons'
      }
    },
    validate_quality: {
      ru: '–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞',
      en: 'Quality Check',
      description: {
        ru: '–í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º',
        en: 'Validation against educational standards'
      }
    },
    validate_lessons: {
      ru: '–ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Ä–æ–∫–æ–≤',
      en: 'Lessons Check',
      description: {
        ru: '–ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ —É—Ä–æ–∫–æ–≤',
        en: 'Checking minimum lessons requirement'
      }
    }
  }
} as const;
```

---

## Appendix B: –ü—Ä–∏–º–µ—Ä EditableField –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞

```tsx
// packages/web/components/generation-graph/panels/output/EditableField.tsx

interface EditableFieldProps {
  value: string;
  onChange: (value: string) => void;
  label?: string;
  placeholder?: string;
  type?: 'text' | 'textarea' | 'number';
  onRegenerate?: (instruction: string) => Promise<void>;
}

export function EditableField({
  value,
  onChange,
  label,
  placeholder,
  type = 'text',
  onRegenerate
}: EditableFieldProps) {
  const [isEditing, setIsEditing] = useState(false);
  const [showChat, setShowChat] = useState(false);
  const [localValue, setLocalValue] = useState(value);

  const debouncedSave = useDebouncedCallback((v: string) => {
    onChange(v);
  }, 1000);

  const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {
    setLocalValue(e.target.value);
    debouncedSave(e.target.value);
  };

  return (
    <div className="group relative">
      {label && (
        <div className="flex items-center justify-between mb-1">
          <label className="text-sm font-medium text-slate-700">{label}</label>
          <div className="flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity">
            <Button
              size="icon"
              variant="ghost"
              className="h-6 w-6"
              onClick={() => setIsEditing(true)}
            >
              <Pencil className="h-3 w-3" />
            </Button>
            {onRegenerate && (
              <Button
                size="icon"
                variant="ghost"
                className="h-6 w-6"
                onClick={() => setShowChat(true)}
              >
                <RefreshCw className="h-3 w-3" />
              </Button>
            )}
          </div>
        </div>
      )}

      {isEditing ? (
        <input
          value={localValue}
          onChange={handleChange}
          onBlur={() => {
            debouncedSave.flush();
            setIsEditing(false);
          }}
          className="w-full px-2 py-1 border rounded"
          autoFocus
        />
      ) : (
        <p
          className="text-slate-900 cursor-pointer hover:bg-slate-50 px-2 py-1 rounded"
          onClick={() => setIsEditing(true)}
        >
          {value || <span className="text-slate-400">{placeholder}</span>}
        </p>
      )}

      {showChat && (
        <InlineRegenerateChat
          onSubmit={async (instruction) => {
            await onRegenerate?.(instruction);
            setShowChat(false);
          }}
          onCancel={() => setShowChat(false)}
        />
      )}
    </div>
  );
}
```

---

## Changelog

| –í–µ—Ä—Å–∏—è | –î–∞—Ç–∞ | –ò–∑–º–µ–Ω–µ–Ω–∏—è |
|--------|------|-----------|
| 1.2.0 | 2025-12-05 | –§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞: –∞–Ω–∞–ª–∏–∑ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ (—á—Ç–æ –ø–æ–¥—Ö–æ–¥–∏—Ç/–Ω–µ –ø–æ–¥—Ö–æ–¥–∏—Ç), –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–π –∞—É–¥–∏—Ç (—á—Ç–æ —Ö–æ—Ä–æ—à–æ/–ø–ª–æ—Ö–æ), –≤—ã—è–≤–ª–µ–Ω–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π (–≤—ã—á–∏—Å–ª—è–µ–º—ã–µ –ø–æ–ª—è, lesson numbering, min 10 lessons) |
| 1.1.0 | 2025-12-05 | –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ Deep Research: Tiered Context Strategy, Dependency Graph, Stale Data Indicators, Impact Analysis Modal, Semantic Diffing, XML-structured prompts, Bloom's validation |
| 1.0.0 | 2025-12-05 | –ü–µ—Ä–≤–∞—è –≤–µ—Ä—Å–∏—è –¢–ó |
